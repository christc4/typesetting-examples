



                        PART NUMBER:    AC-F502M-DD

                     PRODUCT NAME: KLAD20 USERS GUIDE





     This document applies to KLAD20-AC-7.0-A on KL Model B processors
     only.   It  does  not apply to earlier versions of KLAD20.  It is
     advisable that you refer to KLAD20 specific revisions in order to
     perform any required updates.

     COPYRIGHT 1988 DIGITAL EQUIPMENT CORPORATION, MARLBOROUGH, MASS.

     The  contents  of  this  and  all  KLAD10  or  KLAD20  media  are
     confidential  and  are  the  sole  property  of Digital Equipment
     Corporation.  Their use is intended for Digital personnel only!

     Digital Equipment Corporation does not make available any of  the
     software,  documentation,  or any other files from these media to
     persons not considered authorized employees of Digital  Equipment
     Corporation.

     Individuals who  violate  or  otherwise  disregard  this  warning
     without  previous written consent from LCG CSSE may be subject to
     disciplinary action.

     It is recommended that you carefully read  this  document  before
     attempting to perform any of the indicated procedures.



     EDITED 12 December 1988

KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 2



     KLAD20 VERSION 7.0 
     Support for TOPS-20 7.0
     Edited 12 December 1988
     Supports KLAD20 Version KLAD20-AC-7.0-A





                                   CONTENTS

        A       KLAD20 INTRODUCTION (READ ME FIRST)  . . . . . . . . 3
        A.1       CONTENTS OF THE KLAD20 PACK:   . . . . . . . . . . 3
        A.2       WHAT'S NEW/DIFFERENT ON KLAD20 V7.0  . . . . . . . 4
        A.3       DESCRIPTIONS OF DIRECTORIES ON KLAD20  . . . . . . 4

        B       CONVENTIONS USED IN THIS DOCUMENT  . . . . . . . . . 6

        C       CREATING A KLAD20 FROM DUMPER TAPES  . . . . . . . . 7
        C.1       REQUIREMENTS . . . . . . . . . . . . . . . . . . . 7
        C.2       SETUP TO BUILD A KLAD20 PACK FROM TAPES  . . . . . 8
        C.3       HOW TO PUT YOUR SYSTEM'S SERIAL NUMBER ON THE 
                  KLAD20 . . . . . . . . . . . . . . . . . . . . .  17

        D       MIC FILE TO RESTORE YOUR PACK FROM TAPE 
                (RESTOR.MIC) . . . . . . . . . . . . . . . . . . .  19

        E       USING KLAD20 . . . . . . . . . . . . . . . . . . .  21
        E.1       STAND-ALONE DIAGNOSTIC USAGE WITH KLDCP. . . . .  21
        E.2       USING KLAD20 WITH TOPS-20 IN TIMESHARING MODE  .  24

        F       UETP . . . . . . . . . . . . . . . . . . . . . . .  25

        G       TAILORING TOPS-20 FOR YOUR SYSTEM  . . . . . . . .  26

        H       MAKBUG . . . . . . . . . . . . . . . . . . . . . .  26

        I       COPYING YOUR PACK  . . . . . . . . . . . . . . . .  28
        I.1       REQUIREMENTS . . . . . . . . . . . . . . . . . .  28
        I.2       OVERVIEW . . . . . . . . . . . . . . . . . . . .  28
        I.3       COPYING PROCEDURE  . . . . . . . . . . . . . . .  28

        J       BACKING UP YOUR KLAD20 . . . . . . . . . . . . . .  31
        J.1       REQUIREMENTS . . . . . . . . . . . . . . . . . .  31
        J.2       BACKUP PROCEDURE . . . . . . . . . . . . . . . .  31
        J.3       NOTES  . . . . . . . . . . . . . . . . . . . . .  32

        K       MIC FILE TO SAVE YOUR PACK ON TAPE (SAVE.MIC)  . .  33

        L       UPDATING KLAD20 WITH NEW DIAGNOSTICS . . . . . . .  37

KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 3






A  KLAD20 INTRODUCTION (READ ME FIRST)
   -----------------------------------


     KLAD20 (KL Advanced Diagnosis for TOPS-20) consists  of  software
     to  run  and  diagnose  a  TOPS-20  system.  It is contained on a
     single disk  pack.   This  informational  guide  describes  basic
     features  of  KLAD20  and  gives  you helpful hints for using the
     tool.  It also contains instructions on how  to  build  a  KLAD20
     disk pack and back up the contents to disk and tape.

     Further information about KLAD20 can  be  gained  from  your  LCG
     experienced   co-workers   or  through  the  normal  LCG  support
     structure.   Additional  information  on  the  contents  of  this
     package  and  how it was put together can be obtained through the
     LCG Support Hot Line at DTN:  297-5000  (508-467-5000)  or  Enet:
     SUPPORT@GIDNEY (GIDNEY::SUPPORT).



A.1  CONTENTS OF THE KLAD20 PACK:
     ----------------------------


     1.  A complete version of the operating system  (runnable  MONMAX
         monitor  in  <SYSTEM>MONITR.EXE).  This monitor will work for
         all DECSYSTEM-20 based hardware versions.

         This monitor is the Version 7.0 TOPS-20 monitor submitted  to
         SDC  to  be distributed to the customer plus Autopatch 19 and
         one patch necessary to run on a  TOPS-20  system  without  an
         NI20.   It  was  necessary  to  use Autopatch 19 because UETP
         needs AP19's GALAXY to run properly.

     2.  The contents of the current diagnostic tapes and the   
         diagnostics  to down-line load and test secondary PDP-11s are
         located in the front-end area [6,11] and in    
         <2-DIAGNOSTICS> on the DECSYSTEM-20 side.

         Two diagnostics  (DFPTA  and  DFKCC)  have  been  updated  to
         reflect fixes made by TOPS engineering.

     3.  The contents of the current diagnostic tapes in the front-end
         file system UIC [6,11].

     4.  A Field Service work area (<F-S>; password  FS).   This  area
         contains a full list of diagnostics in files DDXLA and DFXLK.
         It is recommended to log in  and  work  under  <F-S>  to  get
         automatic  read access to the diagnostics and the batch files
         for <UETP.LIB>.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 4
KLAD20 INTRODUCTION (READ ME FIRST)


     5.  A   full   directory   of   the    DECSYSTEM-20    side    in
         <UTILITIES>KLAD20.DIR  and  a directory of the PDP-11 side in
         <UTILITIES>FE11.DIR.

     6.  Current manuals in <MANUALS>.  Beware, these manuals are only
         for internal use, not for customers.


     With the exception of <OPERATOR>, <F-S>, and  <MFG>,  which  have
     "WHEEL" capabilities, all other areas are "files only" and can be
     modified from only one of the above areas.



A.2  WHAT'S NEW/DIFFERENT ON KLAD20 V7.0
     -----------------------------------


     1.  Resolutions for problems with diagnostics DFPTA and DFKCC.

     2.  The monitor on KLAD20 is the one distributed to the  customer
         plus  TOPS-20  Autopatch  19  and a patch to correct problems
         when running 7.0 on a system without an NI20.  AP19's  GALAXY
         is needed so that UETP will run.

     3.  The KLAD20 User's Guide was updated.

     4.  MAKBUG  is  an  unsupported  tool  created  by  the   TOPS-20
         engineering  group  to  give a brief description of bugchecks
         and bughalts.  More on this tool later in this guide.




A.3  DESCRIPTIONS OF DIRECTORIES ON KLAD20
     -------------------------------------


     [1-DIAGNOSTICS]

        Special support programs D20MON, SUBKL

     [2-DIAGNOSTICS]

        KL10 and KL10 peripheral user mode diagnostics

     [3-DIAGNOSTICS]

        Diagnostics used on DN20

     [4-DIAGNOSTICS]

        Work area used to PIP diagnostics to PDP-11 side of KLAD


KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 5
KLAD20 INTRODUCTION (READ ME FIRST)


     [ACCOUNTS]

     [DECNET]

     [DECNET-SOURCES]

     [DECNET-TOOLS]

     [DN20]

     [F-S]

        Field Service area.  Contains directories of the diagnostic tapes.

     [FIELD-IMAGE]

        Field Image Layered Products

     [HELP]

        Help files

     [MANUALS]

        Manuals useful for KLAD

     [MFG]

        Manufacturing area

     [MFG.CMDS]

        Manufacturing command files

     [MFG.SRC]

        Manufacturing source files

     [MFG.UPD]

        Manufacturing update files

     [OPERATOR]

     [SPOOL]

     [SUBSYS]

     [SYSTEM]

     [TOOLS]

     [UETP]


KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 6
KLAD20 INTRODUCTION (READ ME FIRST)


        User Environment Test Package area

     [UETP.LIB]

        UETP files

     [UETP.RUN]

     [UNSUPPORTED]

        Unsupported files useful to KLAD

     [UTILITIES]

        Files used to build and maintain the KLAD pack



B  CONVENTIONS USED IN THIS DOCUMENT
   ---------------------------------


     Underlining:

          Indicates input that the user is to type at the terminal.

     Prompt:

          Indicates that the system is waiting for terminal input from
          the operator (user).

     <CR>

          Indicates that the user is to type a  carriage  return.   In
          most  cases,  it is assumed that the user will terminate all
          keyboard  entries  with  a  <CR>,  unless  directed  to   do
          otherwise.

     $ (dollar sign)

          Indicates that the ESC or ALT-MODE key has been used.   When
          this  character  appears  within text or a command sequence,
          the user is directed  to  type  the  ESC  or  ALT-MODE  key,
          whichever is available on the keyboard.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 7
CREATING A KLAD20 FROM DUMPER TAPES


C  CREATING A KLAD20 FROM DUMPER TAPES
   -----------------------------------


                              *** WARNING ***

             Before beginning any portion of  this  operation,
             remove  all  customer disk packs, magnetic tapes,
             and system floppy media,  and  place  them  in  a
             secure area away from the system.




C.1  REQUIREMENTS
     ------------


     1.  A DECSYSTEM-20 with one magtape, one dual-ported disk  drive,
         and a console terminal.

     2.  A formatted and verified disk pack.

         BEWARE:  When the pack  is  formatted-  DO  NOT  MAPOUT  SOFT
         ERRORS!!

     3.  A verified system on which the "B" string has been run.

     4.  The KLAD-20 backup tapes (four tapes) and system floppies.

     5.  This document.

     6.  Approximately 90 minutes to carry out the procedure.


KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 8
CREATING A KLAD20 FROM DUMPER TAPES


C.2  SETUP TO BUILD A KLAD20 PACK FROM TAPES
     ---------------------------------------


     Mount the  formatted  pack  on  a  dual-ported  drive  (unit  0),
     write-enabled.

     Mount Floppy A into left-hand (0) floppy drive and Floppy B  into
     right-hand (1) floppy drive.

     Mount first magtape (1 of 4) on unit 0 (write-protected).

     Set PDP-11 switches to 000003 (switches 0  and  1  up,  the  rest
     down) and press ENABLE and SWITCH-REGISTER simultaneously.


                             ***** NOTE *****

             For the purposes of demonstration, this  document
             assumes  that  the system you are using is a 2060
             model B with MOS memory.  If the system  you  are
             using  is an older 2040/2050 model A or a model B
             or newer, the command interface to KLI  does  not
             vary  to  any  great  degree from previous KLAD20
             build procedures.

             This document shows the differences  in  the  KLI
             interface  that  have  been  introduced since the
             advent of MOS memory.


        After some floppy traffic you will see:         

        [SY0: REDIRECTED TO DX0:]
        [DX0: MOUNTED]
        [DX1: MOUNTED]

     Begin the process by typing a control-backslash (^\).


     1.  ^\
         --

         This activates PARSER.  One of the following prompts appears:
         PAR% or PAR>

         Next, enter the program KLI.

     2.  PAR>MC KLI<CR>
             -- ---

         After a few seconds and heavy floppy traffic, the program KLI
         will start and prompt with questions requiring user input.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                       Page 9
CREATING A KLAD20 FROM DUMPER TAPES


         KLI -- VERSION VBxx-xx RUNNING
         KLI -- ENTER DIALOG [NO, YES, EXIT, BOOT]?

     3.  KLI>YES<CR>
             ---

         KLI -- KL10 S/N: XXXX., MODEL B, 60 HERTZ
         KLI -- KL10 HARDWARE CONFIGURATION:
                MOS MASTER OSCILLATOR
                EXTENDED ADDRESSING
                INTERNAL CHANNELS
                CACHE                                     

         * NOTE * XXXX is your system serial number

         If you have MCA25 on your machine, you will be prompted  with
         the following question.  Answer BOTH.

         KLI -- SELECT PAGE TABLE [FILE,BOTH,0,1]?

     4.  KLI>BOTH<CR>
             ----

         KLI -- RELOAD MICROCODE [YES, VERIFY, NO]?

     5.  KLI>YES<CR>
             ---

         KLI -- MICROCODE VERSION x.x[xxx] LOADED

         The next question deals with enabling cache.  If your  system
         does  not  have  cache, you will not see this prompt, and you
         should go directly to Step 7.

         KLI -- RECONFIGURE CACHE [FILE, ALL, YES, NO]?

     6.  KLI>ALL<CR>
             ---

         KLI -- ALL CACHES ENABLED

         KLI -- CONFIGURE KL MEMORY [FILE,ALL,REVERSE,FORCE,YES,NO]?

     7.  KLI>FORCE<CR>
             -----

         STARTING MF20 DBE SCAN.  WAIT 25 SEC/256K.

         (Depending on your system configuration, this will  take  one
         to eight minutes.  The average is one to three minutes.)

         MEMORY RESOURCES:
         CONTROLLER ADDRESS  TYPE  MODULES/GROUPS
                                  7 6 5 4 3 2 1 0

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 10
CREATING A KLAD20 FROM DUMPER TAPES


          
                10         MF20   0 0 0 0 0 0 0 4

         KLI -- CONFIGURE MOS MEMORY [ALL,YES,NO]?

     8.  KLI>ALL<CR>
             ---

                                  ** NOTE **

                 Your site may  not  have  the  same  type  of
                 memory  as in the example illustrated in this
                 document.  As a result, this portion may  not
                 be  exactly  the same as the printout on your
                 CTY.  If your system  has  core  memory,  KLI
                 will  ask about configuration.  Your response
                 should be ALL,
                           ---

                                  U N L E S S

                 you are reconfiguring  memory  because  of  a
                 storage module failure, or you suspect errors
                 in a given section of memory.


         LOGICAL MEMORY CONFIGURATION,
           ADDRESS  SIZE  INT  TYPE CONTROLLER
         00000000   256K    4   MF20  0   10

         KLI -- LOAD KL BOOTSTRAP [YES, NO, FILENAME]?

     9.  KLI>MTBOOT<CR>
             ------

         KLI -- WRITE CONFIGURATION FILE [YES,NO]?

    10.  KLI --NO<CR>
               --

         KLI -- BOOTSTRAP LOADED AND STARTED

    11.  MTBOOT>/L<CR>
                --

         Tape will load monitor into DECSYSTEM-20 memory.

         After a short period you will see the prompt  MTBOOT>  again.
         Start at the 'REFRESH' entry point.

    12.  MTBOOT>/G143<CR>
                -----

         DO YOU  WANT  TO  REPLACE  THE  FILE  SYSTEM  ON  THE  SYSTEM

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 11
CREATING A KLAD20 FROM DUMPER TAPES


         STRUCTURE?

    13.  YES<CR>
         ---

         DO YOU WANT TO DEFINE THE SYSTEM STRUCTURE?

    14.  YES<CR>
         ---

         HOW MANY PACKS ARE IN THIS STRUCTURE?

    15.  1<CR>
         -

         NOTE:  KLAD is ALWAYS a one-pack structure!

         ON WHICH "CHANNEL, UNIT" IS LOGICAL PACK   0 MOUNTED:

    16.  ?<CR>
         -

                                  ** NOTE **

                 We have asked you to  type  a  question  mark
                 because  it  is possible that your system may
                 not be using channel 1 for logical disk  unit
                 0.   In this example, we are using channel 1,
                 logical disk unit 0.  When you type  "?"  the
                 system  tells  you what channels and units it
                 believes it has, as well  as  disk  type  and
                 status.

         [ENTER A PAIR OF NUMBERS SEPARATED BY A  COMMA  THAT  SPECIFY
         THE  CHANNEL  AND  UNIT  UPON  WHICH  THE APPROPRIATE PACK IS
         MOUNTED.  THE FOLLOWING IS A  LIST  OF  VALID  CHANNEL,  UNIT
         PAIRS:

                                   EXAMPLE:

         0,-1,0 ;TYPE=RP06,DUAL PORT

         ON WHICH CHANNEL, UNIT IS LOGICAL UNIT 0 MOUNTED :?

    17.  0,-1,0<CR>
         ------

         DO YOU WANT THE DEFAULT SWAPPING SPACE?

    18.  ?<CR> (This  will  make  the  system  print  out  the  system
         -
         default.)

         [THE DEFAULT IS xxxxx PAGES]

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 12
CREATING A KLAD20 FROM DUMPER TAPES


         DO YOU WANT THE DEFAULT SWAPPING SPACE?

         If the default is 15010 pages, type YES.  If the  default  is
         less than 15010 pages, type NO to the default and enter 15010
         pages for the default swapping space.

    19.  Y<CR>
         -

         DO YOU WANT THE DEFAULT SIZE FRONT-END FILE SYSTEM?

    20.  ?<CR>
         -

         [THE DEFAULT IS 950 PAGES]

         DO YOU WANT THE DEFAULT SIZE FRONT-END FILE SYSTEM?

    21.  NO<CR>
         --

         HOW MANY PAGES FOR THE FRONT-END FILE SYSTEM?

    22.  9000<CR>
         ----

         DO YOU WANT THE DEFAULT SIZE BOOTSTRAP AREA?

    23.  YES<CR>
         ---

         DO YOU WANT TO ENABLE  PASSWORD  ENCRYPTION  FOR  THE  SYSTEM
         STRUCTURE?

    24.  YES<CR>
         ---

         WHAT IS THE NAME OF THIS STRUCTURE?


    25.  PS:<CR>
         ---


                                  ** NOTE **

                 If your disk pack was not formatted using the
                 PAKINT   command,   you   may  be  asked  the
                 following question:

                 WANT TO WRITE A PROTO-TYPE SET OF BAT BLOCKS?

         If this message does not appear, go to Step 27.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 13
CREATING A KLAD20 FROM DUMPER TAPES


    26.  YES<CR>
         ---

         [STRUCTURE PS SUCCESSFULLY DEFINED]
         [PS:  MOUNTED]


                                  ** NOTE **

                 Continue  the  procedure  if  you   see   the
                 message:
                                  %%NO SETSPD

                 This is normal!


    27.  ENTER TODAY'S DATE AND TIME AS DD-MM-YY HHMM<CR>

                15-NOV-88 1431          (Example)
          
         YOU HAVE ENTERED 15 NOV 1988 2:31 PM
         IS THIS CORRECT (Y,N)

    28.  YES<CR>        (If date is correct)
         ---

         The next response may take some time.

         WHY RELOAD?

         (The "NOLODF" BUGCHK is normal; continue with procedure.)

                ******************
                *BUGCHK "NOLODF" AT 15-NOV-88 14:32:00
                *COULD NOT FIND CI-20 MICROCODE LOAD PROGRAM
                *JOB: 0, USER: OPERATOR
                ******************

    29.  OTHER KLAD-BUILD<CR>
         ----- ----------

         You may see the following message:

         PROBLEM WITH <SYSTEM>ACCOUNTS-TABLE.BIN
         CANNOT FIND  ERROR  MESSAGE  FILE  -  ACCOUNT  VALIDATION  IS
         DISABLED

         This is not an error.  Continue with procedure.

         NO SYSJOB      (this is normal)

         Type <CTRL>C to get to mini-exec.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 14
CREATING A KLAD20 FROM DUMPER TAPES


    30.  ^C
         --

         NO EXEC
         MX>

         Now we get the system EXEC from the KLAD tape.  When you type
         the  following  command,  note  that  the system fills in the
         missing letters.


    31.  MX>GMTA0:<CR> (echoes as:  GET FILE MTA0:)
            ------

         ?
         MX>

         This  is  expected,  because  the  tape  is   not   correctly
         positioned.  Type the command again.


    32.  MX>GMTA0:<CR> (echoes the same as Step 31)
            ------

         (If, after you type GMTA0: the second time, you still  get  a
         question mark, there may be a problem reading the tape on the
         tape drive.  If this happens, dismount the tape, mount it  on
         MTA1,  and  start the procedure over from the beginning.  You
         do not have to specify MTA1.  When you type MTA0, the  system
         looks at drive MTA0, and if there is no tape on the drive, it
         looks at MTA1.)

    33.  MX>S<CR>       (echoes as START)
            -

         TOPS-20 COMMAND PROCESSOR 7.0(xxxx)
         @

    34.  @ENABLE<CR>
          ------

    35.  $RUN MTA0:<CR>
          --- -----

         This runs DLUSER, the next sequential file on the KLAD tape

         DLUSER>

    36.  DLUSER>LOAD MTA0:<CR>
                ---- -----

         This creates the directories and their quotas  on  your  disk
         structure.  It will take approximately one minute.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 15
CREATING A KLAD20 FROM DUMPER TAPES


         You may see the message:

         CANNOT FIND ERROR MESSAGE  FILESTR:  UNDEFINED  ERROR  NUMBER
         PS:<ROOT-DIRECTORY>

         This is not  a  real  error  condition.   Continue  with  the
         procedure.

         Prompt:  DONE!

    37.  DLUSER>EXIT<CR>
                ----

         Now that the directories  are  created,  you  can  begin  the
         restoration process.  The first part is done manually.

    38.  $RUN MTA0:<CR>
          --- -----

         This loads and runs DUMPER, the next  sequential  program  on
         the  KLAD  tape.   DUMPER  is used to restore the directories
         <SYSTEM> and <UTILITIES>.

         Prompt:  DUMPER>

    39.  DUMPER>TAPE MTA0:<CR>
                ---- -----


    40.  DUMPER>ACCOUNT SYSTEM-DEFAULT<CR>
                ------- --------------

         Next,   restore   the   PS:<SYSTEM>   area   and   then   the
         PS:<UTILITIES> area.

                                 *** NOTE ***

                 Continue  the  procedure  if  you   see   the
                 message:

                    ? SEQUENCE ERROR, RECORD 1, CONTINUING

                 This is not an error.


    41.  DUMPER>RESTORE <*>*.*.* PS:<*>*.*.*<CR>
                ------- -------- -----------

         DUMPER TAPE #1, KLAD20-AC-7.0-A EXEC,ERRMES.BIN, TUESDAY 15-NOV-88
         LOADING FILES INTO PS:<SYSTEM>
         ?SEQUENCE ERROR, RECORD 1, CONTINUING
          
         END OF SAVESET
          

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 16
CREATING A KLAD20 FROM DUMPER TAPES


         DUMPER>

    42.  DUMPER>RESTORE <*>*.*.* PS:<*>*.*.*<CR>
                ------- -------- -----------

         DUMPER TAPE #1, KLAD20-AC-7.0-A <UTILITIES>, TUESDAY 15-NOV-88
         LOADING FILES INTO PS:<UTILITIES>
         ?SEQUENCE ERROR, RECORD 1, CONTINUING
          
         END OF SAVESET
          
         DUMPER>

    43.  DUMPER>EXIT<CR>
                ----

                                  ** NOTE **

                 Do NOT remove the KLAD tape from  the  drive.
                 It will be used when RESTOR.MIC is run next.


         Now that the manual operations are nearly complete,  you  can
         start the automated part of the KLAD creation process.

    44.  $DO <UTILITIES>RESTOR.MIC<CR>
          -- ---------------------

         If you are using a tape drive other than MTA0,  redefine  the
         logical name MAG by typing the following command at the break
         point in the MIC file:

         DEFINE MAG:  MTA1:
         ------ ----  -----

         Follow the instructions typed by the MIC file to restore  all
         tapes.

                                  ** NOTE **

                 Other than when  specifically  requested,  do
                 not  type  anything while the RESTOR.MIC file
                 is   running.     This    includes    control
                 characters.


    45.  At the end of RESTOR.MIC you will see the DUMPER> prompt.  At
         that point, type the following:

         DUMPER>UNLOAD
                ------
         DUMPER>EXIT
                ----

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 17
CREATING A KLAD20 FROM DUMPER TAPES


         Type CONTROL P (<CTRL>P) to finish the MIC file.
              ------- -

    46.  After RESTOR.MIC is complete, run FE-REWRITE.MIC.  If you  do
         not run this MIC file, you will not be able to make a pack to
         pack copy of the KLAD.   To  run  this  MIC  file,  type  the
         following command:

         $DO <UTILITIES>FE-REWRITE.MIC
          -- -------------------------




C.3  HOW TO PUT YOUR SYSTEM'S SERIAL NUMBER ON THE KLAD20
     ----------------------------------------------------

     Follow the procedures in Section G (with help from the TOPS-20 KL
     Model  B  Installation  Guide)  to tailor the system according to
     your peripherals.

 1.  Press <CTRL>\ to get the PARSER.  The prompt will be PAR>
           -------

 2.  Type SHUTDOWN<CR> to stop timesharing and halt the KL.
          --------

     Prompt:  ***KL HALTED***

     Set the switches on the PDP-11 to 0207 (switches 0,1,2,7 up).


 3.  Press ENABLE and DISK buttons on PDP-11 simultaneously.

     The KL will now load microcode, configure memory and load  boots.
     A  <CR>  at  the  BOOT> prompt will load the default monitor from
     PS:<SYSTEM>MONITR.EXE.

     Prompt:  ENTER TIME AND DATE


 4.  After entering the time  and  date  and  answering  YES,  if  you
     entered  it  correctly,  run  CHECKD  to make sure that your file
     system is clean (any errors prefixed with a "?" need intervention
     -  the ones with a "%" sign get fixed automatically).  Let PTYCON
     start the operator jobs.  Finally, log in as  OPERATOR  (password
     is  KLAD, account   is not required), enable your privileges, and
     connect to the directory <SYSTEM>.

     Now, change the serial number on the KLAD pack  to  reflect  your
     system's  serial  number.   You do this by editing MONNAM.TXT and
     replacing the dummy serial number "1234" with your serial number,
     as shown below.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 18
CREATING A KLAD20 FROM DUMPER TAPES


     1.  @LOG OPERATOR KLAD

     2.  @ENABLE                      ;enable privileges        

     3.  $CONNECT <SYSTEM>            ;this is where the file resides

     4.  $TV MONNAM.TXT               ;this file contains the serial
                                      ;number

     5.  R1234$XXXX$$                 ;where XXXX = your system's
                                      ;serial number

     6.  ;X$$                         ;the $ sign indicates the ESC or
                                      ;ALT-MODE key.  This closes
                                      ;the file.

     7.  OUTPUT FILE?  MONNAM.TXT.1   ;we want to keep the generation
                                      ;number at .1

     8.  $EXPUNGE                     ;releases old disk space

     9.  $CONNECT <OPERATOR>          ;get back to your own directory

    10.  $DEL *.TV                    ;deletes unnecessary files

    11.  $EXPUNGE                     ;frees needed disk space


     It is recommended that you change  the  password  for  <OPERATOR>
     (KLAD) and for <F-S> (FS) to the cost center number that services
     this system and that you make this change known  to  the  Digital
     Diagnostic Center (DDC) in Colorado Springs, Colorado.

     Example:  Cost Center 70W services your system.  In this case the
     passwords for <OPERATOR> and <F-S> would be CC70W.

     This will allow you to keep tighter control over  KLAD  and  will
     allow  DDC  (Colorado) and other DEC-internal support to get onto
     KLAD in case of an emergency.

     You can change the  passwords  with  one  of  the  following  two
     commands:

     1.  $BUILD

     2.  $SET DIRECTORY PASSWORD        


KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 19
MIC FILE TO RESTORE YOUR PACK FROM TAPE (RESTOR.MIC)


D  MIC FILE TO RESTORE YOUR PACK FROM TAPE (RESTOR.MIC)
   ----------------------------------------------------

     ;****************************************************************
     ;* Mic file to start the second phase of a FULL KLAD-20 RESTORE.*
     ;*                                                              *
     ;* ASSUMPTIONS: EXEC.EXE and ERRMES.BIN in PS:<SYSTEM>          *
     ;*              DIRECTORY <UTILITIES> restored                  *
     ;*                                                              *
     ;*              FRONT-END-AREA previously defined as            *
     ;*              length of 9000 pages                            *
     ;*                                                              *
     ;****************************************************************
     ;
     MAGTAP::
     ;
     ;
     @DEFINE MAG: MTA0:
     ;
     ;  Type "^P" when ready.
     =^B
     ;
     @
     @ERROR
     @ENABLE
     ;
     @DAYTIME
     @TERMINAL NO PAGE
     @TERMINAL LENGTH 0
     @DAYTIME
     ;
     @RU <UTILITIES>DUMPER
     *TAPE MAG:
     *FILES
     *ACCOUNT SYSTEM-DEFAULT
     *RESTORE <*>*.*.* PS:<FE-COPY>*.*.*
     *EXIT
     ;
     @CONN PS:<FE-COPY>
     @RUN PS:<UTILITIES>COPYFE
     *<FE-COPY>FRONT-END-FILE-SYSTEM.BIN
     *<ROOT-DIRECTORY>FRONT-END-FILE-SYSTEM.BIN
     @DELETE <FE-COPY>*.*
     @EXPUNGE <FE-COPY>
     @RESET
     ;
     @ENABLE
     @BUILD <OPERATOR>
     *PASS KLAD
     *ACC F-S
     *
     @
     @CONN <SYSTEM>
     @RU PS:<UTILITIES>MAKDMP

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 20
MIC FILE TO RESTORE YOUR PACK FROM TAPE (RESTOR.MIC)


     *CREATE PS:<SYSTEM>DUMP.EXE 4096
     *EXIT
     @
     @UNLOAD MAG:
     ;
     ;  Mount tape 2 on tape drive.
     ;  Type "^P" when ready.
     ;
     ;NOTE:     To use magtape other than MTA0: redefine MAG:
     ;
     =^B
     ;
     @RU PS:<UTILITIES>DUMPER
     *TAPE MAG:
     *ACCOUNT SYSTEM-DEFAULT
     *RESTORE <*>*.*.* <*>*.*.*
     ;*****************************************************************
     ;*      WHEN TAPE #1 HAS FINISHED, DUMPER WILL UNLOAD THE TAPE   *
     ;*      FROM UNIT 0 & DEMAND A NEW TAPE FILESPEC.                *
     ;*                                                               *
     ;*      WHEN THE TAPE HAS BEEN UNLOADED, MOUNT TAPE #2           *
     ;*      & TYPE "MTA?:", ? IS THE # OF THE UNIT YOU ARE USING.    *
     ;*      CONTINUE UNTIL ALL TAPES ARE RESTORED.                   *
     ;*                                                               *
     ;*      WHEN ALL TAPES HAVE BEEN RESTORED                        *
     ;*      TYPE "^P" TO FINISH                                      *
     ;*                                                               *
     ;*****************************************************************
     ;
     =^B
     ;
     ;
     @GOTO END
     %ERR::
     ;
     ;  ERROR in RESTOR.MIC
     ;
     END::
     @DAY
     @KMIC

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 21
USING KLAD20


E  USING KLAD20
   ------------

E.1  STAND-ALONE DIAGNOSTIC USAGE WITH KLDCP.
     ----------------------------------------

     Using the latest release of KLDCP, you can  run  all  diagnostics
     (pack modifying diagnostics excluded).

     EXAMPLE:  Fast check to see if the KL is alive  and  RH11  access
               ---- ----- -- --- -- --- -- -- -----  ---  ----  ------
     works.
     ------

     1.  Mount KLAD-20 pack on unit 0 (dual port RP06)

     2.  Set PDP-11 switches to octal 203.

          o  Bit 7          boot from disk.

          o  Bits 0,1       don't start KLI up.

          o  Bits 8, 9, 10  are the unit number of the disk as seen
                            from the RH11, in this case unit 0.


     3.  Press ENABLE and SWITCH REGISTER buttons simultaneously.

     4.  Wait until the CTY prints "[DB0:  MOUNTED]".

     5.  Type <CTRL>\ to call the PARSER.
              -------

     6.  If PARSER echoes PAR% or PAR#, skip to step 8.

     7.  If PARSER echoes PAR>, type the following  commands  to  stop
         running the DECSYSTEM-20:

         PAR>SET CONSOLE MAINTENANCE<CR>
             --- ------- -----------
         PAR>SHUTDOWN<CR>
             --------

         You should now see PAR% or PAR#.


     8.  Type MC BOO<CR> to PARSER.
              -- ---

     9.  Type DBOOT<CR> at the BOO> prompt.
              -----

    10.  After some floppy traffic (RESETs) you are in KLDCP.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 22
USING KLAD20


    11.  VERY IMPORTANT- write protect the KLAD-20 pack !!

    12.  Set the PDP-11 switches to the state  the  diagnostic  needs.
         In  the case of the B command, it is run with switches set to
         zero.

         The  KLDCP  program  is  now  activated,  and  you  can   run
         diagnostics.   The  KL10 checkout command file (B-string) can
         be called by typing B<CR> to KLDCP.  This will run  a  series
                             -
         of KL10 diagnostics.

         You can now select other exec diagnostics you wish to run.  A
         complete  list  of  diagnostics  (DDXLA/DFXLK) resides in the
         <F-S> area of KLAD20.

         After you have checked the system, get back to RSX20F in  the
         following way:

             If you have been running any diagnostic which might  have
             left  bad  parity in core, you have to zero memory before
             starting up TOPS-20, since boot  does  not  zero  TOPS-20
             memory.

             KLDCP allows you to zero core in 64k chunks:

             MZ 0,-1         ;Zeroes the first 64K,

             MZ 200000,-1    ;Zeroes the next chunk and so on till you
                             ;have zeroed all core.

             

             There is also a PARSER  command,  which  will  work  much
             slower.  For a 128K system, this command would be

                       ZERO 0>177777<CR>.


    13.  Set the KLAD-20 pack write enabled.  Reset PDP-11 switches to
         octal 203, as you had them in step 2.

    14.  Stop the PDP-11 (HALT switch).

    15.  Write enable the KLAD20 pack.

    16.  Reload and restart the PDP-11 from switches.

    17.  Type SE 173000<CR> to the KLDCP prompt.
              -- ------

    18.  After you see "[DB0:  MOUNTED]", type <CTRL>\
                                               -------

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 23
USING KLAD20


    19.  Type to the PARSER prompt RU KLI<CR>
                                   -- ---

    20.  Follow normal monitor startup procedures.


KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 24
USING KLAD20


E.2  USING KLAD20 WITH TOPS-20 IN TIMESHARING MODE
     ---------------------------------------------

     Beware:  startup of KLAD-20 in timesharing mode requires the pack
     to be write enabled!

     Press the DISK and ENABLE  buttons  simultaneously.   Answer  the
     "TIME  and DATE," "WHY RELOAD," and "RUN CHECKD" questions on the
     CTY, and log in under <F-S> (password FS).  You are now ready  to
     run user-mode diagnostics.

     1.  @ ENABLE<CR>                   ;Give yourself privileges
           ------

     2.  $ CONNECT <2-DIAGNOSTICS><CR>  ;Connect <2-DIAGNOSTICS>
           ------- ---------------

     3.  $ RUN D20MON<CR>               ;TOPS-20 diagnostic monitor.
           --- ------


     D20MON CMD -

     You can now select the user-mode diagnostic to be run.

     Another test  that  is  run  in  timesharing  mode  is  the  User
     Environment  Test Package (UETP).  Information about this package
     is covered later in this guide.

     If you want to return  the  system  to  the  customer,  type  the
     following:

     1.  $<CRTL>ECEASE NOW<CR>
          ------------ ---

     2.  TOPS-20 will be shut down IMMEDIATELY
         [Confirm]

     3.  <CR> confirms that you want to shut down now
         ----

         When "SHUTDOWN COMPLETE" is printed, type <CTRL>\ on the CTY.
                                                   -------
         This will invoke the PARSER.

         Type to the PARSER:

     4.  PAR> SHUTDOWN<CR> to HALT the DECSYSTEM-20
              --------

         You should see:  ***KL HALTED***

     At this point, you can safely remove the  KLAD20  pack  from  the
     drive.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 25
UETP


F  UETP
   ----


     1.  The  User  Environment  Test  Package  is  a  collection   of
         programs,  data  files,  and  batch control files designed to
         allow you to verify the integrity of your TOPS-20 system.

         To run the UETP test package, submit the jobs from the PTYCON
         subjob  "UETP."  When  KLAD20  has  been booted and loads the
         Version 7.0 monitor, a UETP setup  command  file  is  started
         that  handles  practically  everything necessary to run UETP.
         All that you need to do is attach to the F-S job running UETP
         and  submit  the  UETP tests wanted.  Follow the instructions
         outlined  in  UETP  HELP*  in  the  <UETP.LIB>  area  or  the
         instructions  in  the KLAD20-MFG-GUIDE.DOC in the <MFG> area,
         or refer to the UETP Reference Manual in the TOPS-20 Notebook
         Set.

                @ENABLE
                 ------
                $CONNECT UETP<CR>
                 ------- ----
                $RUN UETP
                 --- ----
                UETP>

         * This help can be  accessed  by  typing  HELP  to  the  UETP
         prompt:

                UETP>HELP<CR>
                     ----


     2.  To prevent unwanted line printer output and to stop  all  the
         batch jobs that you submitted, type:

                $CANCEL PRINT */USER:F-S
                 ------ ----- ----------
                $CANCEL BATCH */USER:F-S
                 ------ ----- ----------

         After a period of cleanup, the  command  INFO  OUTPUT  should
         show  that  there is no output pending, and INFO BATCH should
         show that nothing is pending in the batch queues.  It is also
         a  good  idea  to  delete the log files if they are no longer
         needed.  To do this type:

                @ENABLE<CR>            Give yourself privileges
                 ------
                $DELETE <*>*.LOG<CR>   Delete log files
                 ------ --------
                $EXPUNGE <*><CR>       Expunge log files
                 ------- ---

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 26
TAILORING TOPS-20 FOR YOUR SYSTEM


G  TAILORING TOPS-20 FOR YOUR SYSTEM
   ---------------------------------

     To  tailor   your   KLAD   to   your   system,   refer   to   the
     KLAD20-MFG-GUIDE.DOC in the <MFG> area of the KLAD20 pack.  Note,
     the procedures in the <MFG> area are the procedures used  by  the
     Manufacturing  Acceptance  script.  When you connect to the <MFG>
     area and you run CONFIG, the password is MFG or F-S.

     The KLAD20-MFG-GUIDE.DOC file contains helpful  information,  and
     you  should  read it before running UETP or tailoring your KLAD20
     pack.



H  MAKBUG
   ------



     MAKBUG is an unsupported tool developed by TOPS-20 engineering to
     assist  in  understanding  the  causes of bugs(HLT,CHK).  It does
     this by giving a brief description of the bug when  asked  to  do
     so.  There are 1338 bugs that can be displayed.  You can use this
     tool by typing the following:

     @ENABLE <CR>             ; give yourself privileges
      ------
     $CONN <UNSUPPORTED> <CR> ; connect to the <UNSUPPORTED> directory
      ---- -------------
                              ; where MAKBUG resides

     $MAKBUG                  ; runs MAKBUG
      ------

     MAKBUG>                  ; MAKBUG prompt

     MAKBUG> DISPLAY ?        ; will give a list of BUGS available
             ------- -
                              ; for display

     MAKBUG>DISPLAY ILLUUO    ; display info on bug selected, ILLUUO
            ------- ------
                              ; for this example.  Once in MAKBUG,
                              ; "DISPLAY" is necessary for output.
                              ; However info can be accessed by
                              ; simply typing "MAKBUG BUGNAME" from
                              ; monitor prompt.

       ***The following is an example of the output given by MAKBUG:

     BUG.(HLT,ILLUUO,APRSRV,SOFT,<Illegal UUO from monitor context>,
     <<KIMUFL,FLAGS>,<KIMUPC,PC>,<KIMUEF,EFFADR>>


KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 27
MAKBUG


     Cause: The monitor has executed an instruction that the microcode
            as an MUUO. The op code is not 104 (for a JSYS) or one of the
            KA10 floating point instructions.

     Action: This bug is commonly caused by a software problem but can be
             caused by bad hardware. If the hardware checks out OK and
             the BUGHLT is reproducible, then send in an SPR along with 
             the dump and instructions on reproducing the problem.

     Data: FLAGS - Processor flags when MUUO was executed.
           PC - PC in monitor address space where MUUO was executed.
           EFFADR - Effective address of MUUO.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 28
COPYING YOUR PACK


I  COPYING YOUR PACK
   -----------------

I.1  REQUIREMENTS
     ------------


     1.  The KLAD20 master pack.

     2.  A formatted pack with as few soft/hard errors as possible for
         the  KLAD  copy.   When  the pack is formatted, DO NOT mapout
         soft errors!   

     3.  A TOPS-20 system.      

     4.  Two RP06 disk drives.  The drive for  the  KLAD  master  pack
         must  be  dual  ported;  the  drive  for the copy pack single
         ported.        

     5.  Approximately 33 minutes to copy the pack.




I.2  OVERVIEW
     --------

     A MIC file does the copying.

     MAKPAK has the following variables set up for your KLAD pack:

                Swapping space:         15010 pages             
                Size of front end:      9000 pages      
                Size of DUMP.EXE:       4096 pages

     If you wish to change these variables on the  copy  of  the  KLAD
     pack you are to create, edit the following files:

        [UTILITIES]MAKPAK.MIC   Swapping space, front-end size  
        [UTILITIES]MAKPAK.CTL   Size of DUMP.EXE                



I.3  COPYING PROCEDURE
     -----------------


     1.  Bring up the KLAD system the way you normally do.

     2.  If the UETP jobs start up, either cancel the batch streams or
         type DO <MFG>CANCEL-BATCH.MIC<CR>.     
              -- -------------------------

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 29
COPYING YOUR PACK


     3.  Log in as F-S (password FS).

     4.  Type ENABLE to enable privileges.
              ------

     5.  Type SET TERMINAL WIDTH 132    
              --- -------- ----- ---

     6.  Type CONNECT <UTILITIES>       
              ------- -----------

     7.  Cycle up the formatted pack on an available drive.  Make note
         of the following:

          o  RH20 channel number (variable A in Step 8)

          o  Drive number (variable B in Step 8)

          o  Number in the structure name for Common File System (CFS)
             systems (variable C in Step 8)

         If you do not have a CFS system, you will have to  make  note
         of the channel and drive number.

         With CFS systems, you cannot have multiple KLAD packs running
         as  PS:,  so  you  should name the second KLAD pack PS1:, the
         third one PS2:, and so on.

     8.  Type DO MAKPAK A,B,C<CR>, where
              -- ------ ---------

                A = channel number
                B = drive number
                C = PS:  structure number (only for CFS systems)

     9.  The MIC file runs UNITS  and  asks  you  to  check  the  RH20
         channel  number,  drive  number, and PS number for CFS packs.
         If the information is correct, type <CTRL>P to continue.   If
         it  is  not correct type <CTRL>A to abort the MIC file.  Find
         out the correct channel number and drive number and start the
         copying process again at Step 8.       

    10.  MAKPAK.MIC runs CHECKD to set up the pack and  mounts  it  on
         the  system  with  an  alias.   The  MIC  file  then  submits
         MAKPAK.CTL.  The control file sets up the directories on  the
         pack, copies the front-end file system to the front end (this
         takes  approximately  six  minutes),  and  then  copies   the
         directories from the master KLAD to the copy KLAD one by one.
         The system notifies you as it copies each directory.  This is
         the order in which the batch job copies the directories:


                        <1-DIAGNOSTICS>
                        <2-DIAGNOSTICS>

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 30
COPYING YOUR PACK


                        <3-DIAGNOSTICS>
                        <UETP.LIB>
                        <UTILITIES>
                        <DN20>
                        <DECNET>
                        <DECNET-SOURCES>
                        <DECNET-TOOLS>
                        <FIELD-IMAGE>
                        <F-S>
                        <MANUALS>
                        <MFG>
                        <MFG.SRC>
                        <MFG.CMDS>
                        <MFG.UPD>
                        <NEW-SYSTEM>
                        <NEW-SUBSYS>
                        <OPERATOR>
                        <SUBSYS>
                        <SYSTEM>
                        <UNSUPPORTED>
                        <UTILITIES>
                        <TOOLS>
                        <HELP>

    11.  The copying is complete when  the  batch  job  has  finished.
         Type the following to remove the copy pack:

         R OPR
         - ---
         OPR>DISMOUNT STRUCTURE KLAD:
             -------- --------- -----
         OPR>EXIT
             ----

         Remove the copy of the KLAD pack from the drive.

         If this is the only pack to copy, go to Step 12; otherwise go
         to Step 7.

    12.  Type <CTRL>ECEASE NOW to bring down the system.
              ------------ ---

    13.  Type CTRL\ to get to the PARSER prompt,  and  type  SHUTDOWN.
              -----                                          --------
         The system responds with "DECSYSTEM-20 NOT RUNNING".   

    14.  Remove the master KLAD pack from the drive.


KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 31
BACKING UP YOUR KLAD20


J  BACKING UP YOUR KLAD20
   ----------------------

J.1  REQUIREMENTS
     ------------


      o  KLAD20 online and running TOPS-20

      o  At least four magtapes and one working magtape drive

      o  Approxmately one hour




J.2  BACKUP PROCEDURE
     ----------------


     1.  Log in as <F-S> password FS.

     2.  Mount magtape 1 (this tape will  contain  the  front-end)  on
         unit 0 (write enabled 2400 foot tape required).

     3.  Issue the following commands:

         @ENABLE
          ------
         $CONNECT <UTILITIES>
          ------- -----------
         $DO SAVE PS,0  Where PS is the structure name and 0 is the
          -- ---- ----
                         magtape specifier.

     4.  Follow the instructions in the .MIC file.

     5.  After mounting the second tape, type ^P to start  saving  the
                                              --
         TOPS-20 side of the pack.      

     6.  After DUMPER requests a new tape, dismount the old one, mount
         a new tape, and give a new unit-number to DUMPER.      

     7.  Label tapes as follows:

                _____________________________________________________
                |  KLAD20-AC-7.0-A     DEC-PROPERTY                 |
                |  DATE:                                            |
                |  TAPE x OF y                                      |
                |                                                   |
                |  SAVE BY:______________                           |
                |___________________________________________________|

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 32
BACKING UP YOUR KLAD20


J.3  NOTES
     -----

     The  beginning  of  the  front-end  tape  looks  much  like   the
     installation  tape.   Aside  from  specials, the end of this tape
     holds a save-set of the front-end, which can be restored  to  the
     KLAD  as  long  as  KLAD  has more than 11000 pages free, without
     using the slow and tedious RH11.  Safety features built into  our
     specials   check  the  disk  space  on  logical  contingency  and
     (possible) hardware errors.


                                   NOTE

             The restoration procedure will work only  if  you
             have  declared  a front-end area of 9000 pages at
             monitor startup.


     The full dump tapes (tapes 2-4) can be used to restore  any  lost
     or deleted files on the DECSYSTEM-20 side.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 33
MIC FILE TO SAVE YOUR PACK ON TAPE (SAVE.MIC)


K  MIC FILE TO SAVE YOUR PACK ON TAPE (SAVE.MIC)
   ---------------------------------------------

     @ENABLE
     ;  Mic file to save KLAD on Magtapes.
     ;
     ;  Parameters:
     ;  A = Master Structure = 'A:
     ;  B = Magtape = MTA'B:
     ;
     ;  Type "^P" to continue. Type "^A" to abort.
     ;
     @DEF MTA: MTA0:
     =^B
     ;
     @NOERROR
     @DEF DSK:
     @CONN <UTILITIES>
     @DEL SAVE.LOG
     ;
     @ERROR
     ;
     @
     @ENABLE
     @DAYTIME
     ;
     @DEF DIS: 'A:
     @MOU STR DIS:
     ;
     ASSMAG::
     @DEF MAG: MTA'B:
     @ASSIGN MAG:
     @IF (NOERROR) @GOTO REWMAG
     ;
     ;  ? Can't assign MTA'B:
     ;  Repair problem and type "^P".
     =^B
     @BACKTO ASSMAG
     ;
     REWMAG::
     @REWIND MAG:
     @IF (NOERROR) @GOTO PRIME
     ;
     ;  Put MTA'B: online. Type "^P" when ready.
     ;
     =^B
     @BACKTO REWMAG
     ;
     PRIME::
     ;
     @NOERROR
     @SET FILE INVISIBLE DIS:<SPOOL>*.*
     @SET FILE INVISIBLE DIS:<SYSTEM>DUMP.*
     @DEL DIS:<6-DIAGNOSTICS>*.*.*

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 34
MIC FILE TO SAVE YOUR PACK ON TAPE (SAVE.MIC)


     @EXP DIS:<6-DIAGNOSTICS>
     ;
     ;
     COPY DIS:<UTILITIES>FRONT-END-BOOT.BIN.* DIS:<ROOT-DIRECTORY>
     ;
     ;
     @ERROR
     ;
     @COPY DIS:<SYSTEM>2060-MONBIG.EXE.* DIS:<6-DIAGNOSTICS>
     @COPY DIS:<SYSTEM>EXEC.EXE.* DIS:<6-DIAGNOSTICS>
     @COPY DIS:<SYSTEM>ERRMES.BIN.* DIS:<6-DIAGNOSTICS>
     ;
     ;**********************************************************
     ;                                                         *
     ;  The following steps create KLAD-20 BACKUP-TAPE 1          *
     ;                                                            *
     ;  CONTENTS:       <SYSTEM>2060-MONBIG.EXE                   *
     ;                  <SYSTEM>EXEC.EXE                          *
     ;                  <SUBSYS>DLUSER.EXE                        *
     ;                  DLUSER-FILE to recreate KLAD-DIRECTORIES  *
     ;                  <SUBSYS>DUMPER.EXE                        *
     ;                  <SYSTEM>EXEC.EXE,ERRMES.BIN               *
     ;                  <UTILITIES>                               *
     ;                  <ROOT-DIRECTORY>FRONT-END-SYSTEM-*.BIN    *
     ;                                                            *
     ;  Assumptions:    2400 feet MAGTAPE on UNIT 0               *
     ;                                                            *
     ;  Time requirements:      Roughly 12-15 min WALL-CLOCK time *
     ;                                                            *
     ;**********************************************************
     ;
     @GET DIS:<SYSTEM>2060-MONBIG.EXE
     @SAV MAG:
     @GET DIS:<SYSTEM>EXEC.EXE
     @SAV MAG:
     @GET DIS:<SUBSYS>DLUSER.EXE
     @SAV MAG:
     ;
     @START
     *STRUCTURE DIS:
     *DUMP MAG:
     *EXIT
     ;
     @RESET
     @GET DIS:<SUBSYS>DUMPER.EXE
     @SAV MAG:
     ;
     @CONN DIS:<SYSTEM>
     @START
     *TAPE MAG:
     *SSNAME KLAD20-AC-7.0-A
     *FILES
     *SAVE DIS:<6-DIAGNOSTICS>*.*.* PS:<SYSTEM>*.*.*
     *EXIT

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 35
MIC FILE TO SAVE YOUR PACK ON TAPE (SAVE.MIC)


     ;
     @ENABLE
     @DEL DIS:<6-DIAGNOSTICS>*.*.*
     @EXP DIS:<6-DIAGNOSTICS>
     @CONN <UTILITIES>
     ;
     @START
     *TAPE MAG:
     *FILES
     *SSNAME KLAD20-AC-7.0-A <UTILITIES>
     *SAVE DIS:<UTILITIES>*.*.* PS:<UTILITIES>*.*.*
     *EXIT
     @ENABLE
     @CONN DIS:<ROOT-DIRECTORY>
     ;
     ;*******************************************************************
     ;This step checks the FE-SYSTEM on DISK-ERRORS, it takes some time !
     ;*******************************************************************
     ;
     @RU DIS:<UTILITIES>READFE
     *DIS:<ROOT-DIRECTORY>FRONT-END-FILE-SYSTEM.BIN
     *COPY DIS:<UTILITIES>FRONT-END-BOOT.BIN DIS:<FE-COPY>FRONT-END-BOOT.BIN
     ;
     @DIS:<SUBSYS>DUMPER
     *TAPE MAG:
     *FILES
     *SSNAME KLAD20-AC-7.0-A Front-end-system copy
     *SAV DIS:<ROOT-DIRECTORY>FRONT-END-*.*.* PS:<FE-COPY>
     *EXIT
     ;
     @ENA
     @RU DIS:<UTILITIES>READFE
     *DIS:<ROOT-DIRECTORY>FRONT-END-FILE-SYSTEM.BIN
     *REN DIS:<ROOT-DIRECTORY>FRONT-END-BOOT.BIN DIS:<UTILITIES>*.*.*
     @RESET
     @CONN <SYSTEM>
     @UNLOAD MAG:
     ;
     ;
     TAPE2::
     ;*******************************************************************
     ;
     ;  Now to save the entire TOPS-20 side with DUMPER.
     ;
     ;  Note: To continue at this point with a different tape unit
     ;          redefine MAG: (i.e. @"DEF MAG: MTA1:")
     ;
     TAPCHK::
     ;
     ;  Mount tape 2 on tape drive write enabled and online.
     ;  Type "^P" when ready
     ;
     ;*******************************************************************
     ;

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 36
MIC FILE TO SAVE YOUR PACK ON TAPE (SAVE.MIC)


     ;
     =^B
     ;
     ;  Begin saving entire pack
     ;
     @DUMPER
     *TAPE MAG:
     *ACCOUNT SYSTEM-DEFAULT
     *REWIND
     @IF (ERROR) @BACKTO TAPCHK
     *
     *SSNAME KLAD20-AC-7.0-A SYSTEM-COPY
     *SAVE DIS:<*>*.*.* PS:<*>*.*.*
     ;
     ;
     ;  After the second tape (tape 2) is finished mount next
     ;  tape (write enabled) and reissue tape-drive spec
     ;  to DUMPER.
     ;
     ;  If a second tape drive is available you can
     ;  get it ready and online while the first
     ;  is still writing and issue the new tape-drive spec
     ;  to DUMPER.
     ;
     ;  When all areas have been saved type "^P" to
     ;  finish.
     ;
     ;***********************************************************
     ;
     =^B
     ;
     @NOERROR
     @SET FILE VISIBLE DIS:<SPOOL>*.*
     @SET FILE VISIBLE DIS:<SYSTEM>DUMP.*
     @ERROR
     ;
     @GOTO END
     %ERR::
     ;
     ;  ERROR in SAVE.MIC
     ;
     END::
     @DAY
     @KMIC

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 37
UPDATING KLAD20 WITH NEW DIAGNOSTICS


L  UPDATING KLAD20 WITH NEW DIAGNOSTICS
   ------------------------------------

     The  following  procedure  assumes  that  you  have  the   system
     standalone.   The  monitor  has been started from KLAD and is the
     public structure (PS:) on a dual ported drive.


     1.  Log in to <F-S> (password FS) on the CTY (you  will  need  to
         talk to the front-end later in the procedure).


     2.  Repeat steps a through j for each diagnostic tape:

         a)  Mount diagnostic magtape on MTA0:


         b)  Assign the tape drive and skip the first file.

             $ASSIGN MTA0:<CR>
              ------ -----
             $SKIP MTA0:  1 FILE<CR>            
              ---- -----  - ----

         c)  Run MAGTAP off the tape, and restore the directory of the
             tape to disk.

             $RU MTA0:<CR>                      
              -- -----

             DIAGNOSTIC DISTRIBUTION MAGTAPE CREATOR VERSION 0.5

             MAGTAPE DEVICE - MTA0:<CR>         
                              -----
             WHAT DENSITY?  - 1600<CR>                  
                              ----

             COMMAND - GET MAGTAP.DIR/LIST<CR>  
                       --- ---------------
             COMMAND - <CTRL>C
                       -------


         d)  At monitor level, rename MAGTAP.DIR to  either  DDXLA.DIR
             or DFXLK.DIR, and CONTINUE the MAGTAP program.

             $RENAME MAGTAP.DIR DDXLA.DIR<CR>
              ------ ---------- ---------
                or
             $RENAME MAGTAP.DIR DFXLK.DIR<CR>
              ------ ---------- ---------
             $CONTINUE<CR><CR>
              --------

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 38
UPDATING KLAD20 WITH NEW DIAGNOSTICS


         e)  Restore BEWARE.TXT to disk.

             COMMAND - GET BEWARE.TXT/LIST<CR>
                       --- ---------------


         f)  Interrupt MAGTAP to go back to exec level.

             <CTRL>C <CTRL>C
             ------- -------


                                       NOTE

                 BEWARE.TXT contains a  list  of  the  diagnostics
                 that  have  been  added or changed since the last
                 release.  Look at the diagnostic  tape  directory
                 and  BEWARE.TXT,  and  make a list of diagnostics
                 you want to put on the KLAD.


         g)  Enable privileges, connect to the  diagnostic  work  area
             <4-DIAGNOSTICS>, and CONTINUE the MAGTAP program.

             $ENABLE<CR>                                
              ------
             $CONN <4-DIAGNOSTICS><CR>          
              ---- ---------------
             $CONTINUE<CR>                      
              --------

         h)  Restore  (X=name  Y=extension)  to  <4-DIAGNOSTICS>  from
             magtape.

             Repeat this step until you have  restored  your  list  of
             diagnostics    from    the   diagnostic   tape   to   the
             <4-DIAGNOSTICS> area.

             COMMAND - GET X.Y/LIST<CR>
                       --- --------

                                       NOTE

                 It is preferable to GET the  diagnostics  in  the
                 order  in  which  they appear on the directory to
                 avoid unnecessary rewinds.


         i)  Type UNLOAD to unload the tape and get to monitor level.

             COMMAND - UNLOAD<CR>
                       ------
             $

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 39
UPDATING KLAD20 WITH NEW DIAGNOSTICS


         j)  Remove the tape from the drive.


     3.  Type DIRECTORY to see the restored files in <4-DIAGNOSTICS>.

         $DIRECTORY<CR>                         
          ---------

     4.  Now  see  if  any  of  the  above  diagnostics  are  on   the
         DECSYSTEM-20  side of KLAD.  Repeat this step for all the new
         diagnostics, and mark the files on your list that are on  the
         DECSYSTEM-20 side of the pack.

         DIR <*-DIAGNOSTICS>X.Y<CR>             
         --- ------------------

                Example:  DIR <*-DIAGNOSTICS>DDLPA.A10

                        <2-DIAGNOSTICS>
                        DDLPA.A10.1
          
                        <4-DIAGNOSTICS>
                        DDLPA.A10.1
          
                        In this example, we have to update DDLPA.A10 in
                        <2-DIAGNOSTICS>

         For every diagnostic found on the  DECSYSTEM-20  side,  issue
         the  following  command  with  the  correct  <directory>  and
         filespec.

                      $COPY file.spec <x-DIAGNOSTICS><CR>
                       ---- --------- ---------------

         In the example, the command will be:

                      $COPY DDLPA.A10 <2-DIAGNOSTICS><CR>
                       ---- --------- ---------------

     5.  Copy the diagnostic tape directories to the <F-S> area and do
         a directory of <F-S> to make sure they were copied correctly.
         Then delete the directories from <4-DIAGNOSTICS> and expunge.

         $COPY DDXLA.DIR <F-S><CR>
          ---- --------- -----
         $COPY DFXLK.DIR <F-S><CR>              
          ---- --------- -----
         $DIR <F-S>*.DIR<CR>
          --- ----------
         $DELETE <4-DIAGNOSTICS>*.DIR<CR>
          ------ --------------------
         $EXPUNGE <4-DIAGNOSTICS><CR>
          ------- ---------------

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 40
UPDATING KLAD20 WITH NEW DIAGNOSTICS


     6.  Run the FE program establishing the  DECSYSTEM-20  to  PDP-11
         connection for file transfer.

         $FE<CR>                                
          --
         <CTRL>C <CTRL>C
         ------- -------

     7.  Type DETACH CONTINUE to run FE in a detached state.

         $DETACH CONTINUE<CR>   
          ------ --------

     8.  Mount FE with PARSER.

         <CTRL>\
         -------
         MC MOU<CR>     
         -- ---
         MOU>FE0:<CR>   
             ----
         MOU><CTRL>Z
             -------

     9.  Delete obsolete diagnostics from [6,11] front end with PIP.

         Do a directory of the [6,11] front-end area to see if any  of
         the diagnostics on your update list are on the front-end.  If
         the file is there, delete the old  version  from  the  [6,11]
         area and copy the new file to the [6,11] area.

         <CTRL>\
         -------
         PAR>MC PIP<CR>                 
             -- ---

             Repeat this step for each diagnostic:

             PIP>TT:=DB0:[6,11]X.Y;*/LIST<CR>   
                 ------------------------

             If the file is  on  the  front-end,  type  the  next  two
             commands:

             PIP>DB0:[6,11]X.Y;*/DEL<CR>                
                 -------------------

             PIP>DB0:[6,11]*.*;*=FE0:[340,33]X.Y<CR>
                 -------------------------------



    10.  Type a directory listing of each diagnostic.  The file should
         have today's date and time.

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 41
UPDATING KLAD20 WITH NEW DIAGNOSTICS


         PIP>TT:=DB0:[6,11]X.Y;*/LIST<CR>
             ------------------------

    11.  Create a directory file of all the  files  contained  in  the
         [5,5] and [6,11] directories.  Copy the directory file to the
         DECSYSTEM-20 side in <4-DIAGNOSTICS> area and type <CTRL>Z to
         exit PIP.

         PIP>DB0:[5,5]FE11.DIR=DB0:[*,*]*.*;*/DIR<CR>
             ------------------------------------
         PIP>FE0:[340,33]*.*;*=DB0:[5,5]FE11.DIR;*<CR>
             -------------------------------------
         PIP><CTRL>Z    
             -------

    12.  Dismount FE with PARSER.

         <CTRL>\
         -------
         PAR>MC DMO<CR> 
             -- ---
         DMO>FE0:<CR>   
             ----
         DMO><CTRL>Z
             -------

    13.  Bring in PARSER and attach back to the job you detached  from
         earlier in the procedure.

         <CTRL>\
         -------
         PAR><CTRL>Z
             -------
         <CTRL>C <CTRL>C
         ------- -------
         $ATTACH <F-S> JOB #<CR>        
         ------- ----- --- -

    14.  Run RSXFMT to convert <4-DIAGNOSTICS>FE11.DIR from  RSX-ASCII
         to 7-BIT-ASCII.

         $RSXFMT<CR>
          ------
         RSXFMT>CONVERT FE11.DIR FE11.DIR.1<CR>
                ------- -------- ----------
         RSXFMT>EXIT<CR>
                ----

    15.  Connect   to   <4-DIAGNOSTICS>   and   rename   FE11.DIR   to
         <UTILITIES>.  Delete any files left over in <4-DIAGNOSTICS>.

         $CONN <4-DIAGNOSTICS><CR>
          ---- ---------------

KLAD20 V7.0 USER'S GUIDE 12 December 1988                      Page 42
UPDATING KLAD20 WITH NEW DIAGNOSTICS


         $RENAME FE11.DIR <UTILITIES>FE11.DIR<CR>
          ------ -------- -------------------
         $DELETE <4-DIAGNOSTICS>*.*<CR>
          ------ ------------------
         $EXPUNGE <4-DIAGNOSTICS><CR>           
          ------- ---------------

    16.  Create a directory of the entire pack,  and  put  the  output
         file in <UTILITIES>.

         $CONNECT <UTILITIES><CR>
          ------- -----------
         $VDIR <*>*.*.*,<CR>
          ---- ---------
         $$OUTPUT KLAD20.DIR<CR>
           ------ ----------
         $$<CR>
           ----
         $DIR<CR>       
          ---


     The diagnostic update procedure is now complete.

     Your original backup tapes for KLAD are now obsolete.  Follow the
     procedure in section J to create four new backup tapes.
