SUBROUTINE DBAR

PURPOSE
   TO COMPUTE, AT A GIVEN POINT X, AN APPROXIMATION Z TO THE
   DERIVATIVE OF AN ANALYTICALLY GIVEN FUNCTION FCT THAT IS 11-
   TIMES DIFFERENTIABLE IN A DOMAIN CONTAINING A CLOSED INTERVAL -
   THE SET OF T BETWEEN X AND X+H (H POSITIVE OR NEGATIVE) - USING
   FUNCTION VALUES ONLY ON THAT INTERVAL.

 USAGE
   CALL DBAR(X,H,IH,FCT,Z)
   PARAMETER FCT REQUIRES AN EXTERNAL STATEMENT

DESCRIPTION OF PARAMETERS
   X   - THE POINT AT WHICH THE DERIVATIVE IS TO BE COMPUTED
   H   - THE NUMBER THAT DEFINES THE CLOSED INTERVAL WHOSE END-
	 POINTS ARE X AND X+H (SEE PURPOSE)
   IH  - INPUT PARAMETER (SEE REMARKS AND METHOD)
	 IH NON-ZERO - THE SUBROUTINE GENERATES THE INTERNAL
		       VALUE HH
	 IH    =   0 - THE INTERNAL VALUE HH IS SET TO H
   FCT - THE NAME OF THE EXTERNAL FUNCTION SUBPROGRAM THAT WILL
	 GENERATE THE NECESSARY FUNCTION VALUES
   Z   - RESULTING DERIVATIVE VALUE

REMARKS
   (1)	IF H = 0, THEN THERE IS NO COMPUTATION.
   (2)	THE (MAGNITUDE OF THE) INTERNAL VALUE HH, WHICH IS DETER-
	MINED ACCORDING TO IH, IS THE MAXIMUM STEP-SIZE USED IN
	THE COMPUTATION OF THE ONE-SIDED DIVIDED DIFFERENCES (SEE
	METHOD.)  IF IH IS NON-ZERO, THEN THE SUBROUTINE GENERATES
	HH ACCORDING TO CRITERIA THAT BALANCE ROUND-OFF AND TRUN-
	CATION ERROR.  HH ALWAYS HAS THE SAME SIGN AS H AND IT IS
	ALWAYS LESS THAN OR EQUAL TO THE MAGNITUDE OF H IN AB-
	SOLUTE VALUE, SO THAT ALL COMPUTATION OCCURS IN THE CLOSED
	INTERVAL DETERMINED BY H.

SUBROUTINES AND FUNCTION SUBPROGRAMS REQUIRED
   THE EXTERNAL FUNCTION SUBPROGRAM FCT(T) MUST BE FURNISHED BY
   THE USER.

METHOD
   THE COMPUTATION OF Z IS BASED ON RICHARDSON'S AND ROMBERG'S
   EXTRAPOLATION METHOD AS APPLIED TO THE SEQUENCE OF ONE-SIDED
   DIVIDED DIFFERENCES ASSOCIATED WITH THE POINT PAIRS
   (X,X+(K*HH)/10)K=1,...,10.  (SEE FILLIPI, S. AND ENGELS, H.,
   ALTES UND NEUES ZUR NUMERISCHEN DIFFERENTIATION, ELECTRONISCHE
   DATENVERARBEITUNG, ISS. 2 (1966), PP. 57-65.)
