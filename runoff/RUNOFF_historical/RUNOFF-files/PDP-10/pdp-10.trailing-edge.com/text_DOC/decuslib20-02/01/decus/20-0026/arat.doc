SUBROUTINE ARAT

PURPOSE
   CALCULATE BEST RATIONAL APPROXIMATION OF A DISCRETE
   FUNCTION IN THE LEAST SQUARES SENSE

USAGE
   CALL ARAT(DATI,N,WORK,P,IP,IQ,IER)

DESCRIPTION OF PARAMETERS
   DATI  - TWODIMENSIONAL ARRAY WITH 3 COLUMNS AND N ROWS
	   THE FIRST COLUMN MUST CONTAIN THE GIVEN ARGUMENTS,
	   THE SECOND COLUMN THE GIVEN FUNCTION VALUES AND
	   THE THIRD COLUMN THE GIVEN WEIGHTS IF ANY.
	   IF NO WEIGHTS ARE TO BE USED THEN THE THIRD
	   COLUMN MAY BE DROPPED , EXCEPT THE FIRST ELEMENT
	   WHICH MUST CONTAIN A NONPOSITIVE VALUE
   N	 - NUMBER OF NODES OF THE GIVEN DISCRETE FUNCTION
   WORK  - WORKING STORAGE WHICH IS OF DIMENSION
	   (IP+IQ)*(IP+IQ+1)+4*N+1 AT LEAST.
	   ON RETURN THE VALUES OF THE NUMERATOR ARE CONTAINED
	   IN WORK(N+1) UP TO WORK(2*N), WHILE THE VALUES OF
	   THE DENOMINATOR ARE STORED IN WORK(2*N+1) UP TO
	   WORK(3*N)
   P	 - RESULTANT COEFFICIENT VECTOR OF DENOMINATOR AND
	   NUMERATOR. THE DENOMINATOR IS STORED IN FIRST IQ
	   LOCATIONS, THE NUMERATOR IN THE FOLLOWING IP
	   LOCATIONS.
	   COEFFICIENTS ARE ORDERED FROM LOW TO HIGH.
   IP	 - DIMENSION OF THE NUMERATOR	(INPUT VALUE)
   IQ	 - DIMENSION OF THE DENOMINATOR (INPUT VALUE)
   IER	 - RESULTANT ERROR PARAMETER
	   IER =-1 MEANS FORMAL ERRORS
	   IER = 0 MEANS NO ERRORS
	   IER = 1,2 MEANS POOR CONVERGENCE OF ITERATION
	   IER IS ALSO USED AS INPUT VALUE
	   A NONZERO INPUT VALUE INDICATES AVAILABILITY OF AN
	   INITIAL APPROXIMATION STORED IN P

REMARKS
   THE COEFFICIENT VECTORS OF THE DENOMINATOR AND NUMERATOR
   OF THE RATIONAL APPROXIMATION ARE BOTH STORED IN P
   STARTING WITH LOW POWERS (DENOMINATOR FIRST).
   IP+IQ MUST NOT EXCEED N, ALL THREE VALUES MUST BE POSITIVE.
   SINCE CHEBYSHEV POLYNOMIALS ARE USED AS FUNDAMENTAL
   FUNCTIONS, THE ARGUMENTS SHOULD BE REDUCED TO THE INTERVAL
   (-1,1). THIS CAN ALWAYS BE ACCOMPLISHED BY MEANS OF A LINEAR
   TRANSFORMATION OF THE ORIGINALLY GIVEN ARGUMENTS.
   IF A FIT IN OTHER FUNCTIONS IS REQUIRED, CNP AND CNPS MUST
   BE REPLACED BY SUBROUTINES WHICH ARE OF ANALOGOUS DESIGN.

SUBROUTINES AND FUNCTION SUBPROGRAMS REQUIRED
   APLL, APFS, FRAT, CNPS, CNP
   CNP IS REQUIRED WITHIN FRAT

METHOD
   THE ITERATIVE SCHEME USED FOR CALCULATION OF THE
   APPROXIMATION IS REPEATED SOLUTION OF THE NORMAL EQUATIONS
   WHICH ARE OBTAINED BY LINEARIZATION.
   A REFINED TECHNIQUE OF THIS LINEAR LEAST SQUARES APPROACH
   IS USED WHICH GUARANTEES THAT THE DENOMINATOR IS FREE OF
   ZEROES WITHIN THE APPROXIMATION INTERVAL.
   FOR REFERENCE SEE
   D.BRAESS, UEBER DAEMPFUNG BEI MINIMALISIERUNGSVERFAHREN,
   COMPUTING(1966), VOL.1, ED.3, PP.264-272.
   D.W.MARQUARDT, AN ALGORITHM FOR LEAST-SQUARES ESTIMATION
   OF NONLINEAR PARAMETERS,
   JSIAM(1963), VOL.11, ED.2, PP.431-441.
