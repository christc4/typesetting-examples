SUBROUTINE DAPFS

PURPOSE
   PERFORM SYMMETRIC FACTORIZATION OF THE MATRIX OF THE NORMAL
   EQUATIONS FOLLOWED BY CALCULATION OF THE LEAST SQUARES FIT
   OPTIONALLY

USAGE
   CALL DAPFS(WORK,IP,IRES,IOP,EPS,ETA,IER)

DESCRIPTION OF PARAMETERS
   WORK  - GIVEN SYMMETRIC COEFFICIENT MATRIX, STORED
	   COMPRESSED, I.E UPPER TRIANGULAR PART COLUMNWISE.
	   THE GIVEN RIGHT HAND SIDE OCCUPIES THE NEXT IP
	   LOCATIONS IN WORK. THE VERY LAST COMPONENT OF WORK
	   CONTAINS THE SQUARE SUM OF FUNCTION VALUES E0
	   THIS SCHEME OF STORAGE ALLOCATION IS PRODUCED E.G.
	   BY SUBROUTINE APLL.
	   THE GIVEN MATRIX IS FACTORED IN THE FORM
	   TRANSPOSE(T)*T AND THE GIVEN RIGHT HAND SIDE IS
	   DIVIDED BY TRANSPOSE(T).
	   THE UPPER TRIANGULAR FACTOR T IS RETURNED IN WORK IF
	   IOP EQUALS ZERO.
	   IN CASE OF NONZERO IOP THE CALCULATED SOLUTIONS ARE
	   STORED IN THE COLUMNS OF TRIANGULAR ARRAY WORK OF
	   CORRESPONDING DIMENSION AND E0  IS REPLACED BY THE
	   SQUARE SUM OF THE ERRORS FOR FIT OF DIMENSION IRES.
	   THE TOTAL DIMENSION OF WORK IS (IP+1)*(IP+2)/2
	   WORK MUST BE OF DOUBLE PRECISION
   IP	 - NUMBER OF FUNDAMENTAL FUNCTIONS USED FOR LEAST
	   SQUARES FIT
   IRES  - DIMENSION OF CALCULATED LEAST SQUARES FIT.
	   LET N1, N2, DENOTE THE FOLLOWING NUMBERS
	   N1 = MAXIMAL DIMENSION FOR WHICH NO LOSS OF
		SIGNIFICANCE WAS INDICATED DURING FACTORIZATION
	   N2 = SMALLEST DIMENSION FOR WHICH THE SQUARE SUM OF
		THE ERRORS DOES NOT EXCEED TEST=ABS(ETA*FSQ)
	   THEN IRES=MINO(IP,N1) IF IOP IS NONNEGATIVE
	   AND	IRES=MINO(IP,N1,N2) IF IOP IS NEGATIVE
   IOP	 - INPUT PARAMETER FOR SELECTION OF OPERATION
	   IOP = 0 MEANS TRIANGULAR FACTORIZATION, DIVISION OF
		   THE RIGHT HAND SIDE BY TRANSPOSE(T) AND
		   CALCULATION OF THE SQUARE SUM OF ERRORS IS
		   PERFORMED ONLY
	   IOP = +1 OR -1 MEANS THE SOLUTION OF DIMENSION IRES
		   IS CALCULATED ADDITIONALLY
	   IOP = +2 OR -2 MEANS ALL SOLUTIONS FOR DIMENSION ONE
		   UP TO IRES ARE CALCULATED ADDITIONALLY
   EPS	 - RELATIVE TOLERANCE FOR TEST ON LOSS OF SIGNIFICANCE.
	   A SENSIBLE VALUE IS BETWEEN 1.E-10 AND 1.E-15
   ETA	 - RELATIVE TOLERANCE FOR TOLERATED SQUARE SUM OF
	   ERRORS. A REALISTIC VALUE IS BETWEEN 1.E0 AND 1.E-15
   IER	 - RESULTANT ERROR PARAMETER
	   IER =-1 MEANS NONPOSITIVE IP
	   IER = 0 MEANS NO LOSS OF SIGNIFICANCE DETECTED
		   AND SPECIFIED TOLERANCE OF ERRORS REACHED
	   IER = 1 MEANS LOSS OF SIGNIFICANCE DETECTED OR
		   SPECIFIED TOLERANCE OF ERRORS NOT REACHED

REMARKS
   THE ABSOLUTE TOLERANCE USED INTERNALLY FOR TEST ON LOSS OF
   SIGNIFICANCE IS TOL=ABS(EPS*SNGL(WORK(1))).
   THE ABSOLUTE TOLERANCE USED INTERNALLY FOR THE SQUARE SUM OF
   ERRORS IS ABS(ETA*SNGL(FSQ)).
   IOP GREATER THAN 2 HAS THE SAME EFFECT AS IOP = 2.
   IOP LESS THAN -2 HAS THE SAME EFFECT AS IOP =-2.
   IRES = 0 MEANS THE ABSOLUTE VALUE OF EPS IS NOT LESS THAN
   ONE AND/OR WORK(1) IS NOT POSITIVE AND/OR IP IS NOT POSITIVE

SUBROUTINES AND FUNCTION SUBPROGRAMS REQUIRED
   NONE

METHOD
   CALCULATION OF THE LEAST SQUARES FITS IS DONE USING
   CHOLESKYS SQUARE ROOT METHOD FOR SYMMETRIC FACTORIZATION.
   THE INCORPORATED TEST ON LOSS OF SIGNIFICANCE MEANS EACH
   RADICAND MUST BE GREATER THAN THE INTERNAL ABSOLUTE
   TOLERANCE TOL.
   IN CASE OF LOSS OF SIGNIFICANCE IN THE ABOVE SENSE ONLY A
   SUBSYSTEM OF THE NORMAL EQUATIONS IS SOLVED.
   IN CASE OF NEGATIVE IOP THE TRIANGULAR FACTORIZATION IS
   TERMINATED PREMATURELY EITHER IF THE SQUARE SUM OF THE
   ERRORS DOES NOT EXCEED ETA*FSQ OR IF THERE IS INDICATION
   FOR LOSS OF SIGNIFICANCE
