


     TOPS20.DOC Feb 1980
     TOPS-20 Release 4















     COPYRIGHT (C) 1976,1977,1978,1979,1980 BY
     DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASS.
















     The information in this document is subject to change without notice and
     should   not   be   construed  as  a  commitment  by  Digital  Equipment
     Corporation.

     The software described in this document is furnished under a license and
     may only be used or copied in accordance with the terms of such license.

     No responsibility is assumed for the use or reliability of  software  on
     equipment that is not supplied by DIGITAL or its affiliated companies.
                                                                       Page 2


                                     Summary



     Release 4 of TOPS-20 is a major release  of  the  operating  system,  of
     GALAXY,   of  DECNET,  of  DN200,  and  of  2780/3780/HASP.   There  are
     correspondingly large changes in the documentation  for  these  software
     products.   The  following  documents are specially important sources of
     information concerning release 4.

          1.  Software Installation Guide

              Describes  the  software  contents  of  the  release  and   the
              procedures for installing both TOPS-20 and GALAXY.

          2.  TOPS20.BWR

              This file contains information which was  generated  after  the
              printed  documents  were  "frozen"  but  which  is  vital  to a
              successful installation and use of the software.   This  covers
              both TOPS-20 and GALAXY.

          3.  TOPS-20 System Manager's Guide

              This manual provides information on the  software  capabilities
              of  the  administrator  for  controlling and accounting for the
              system usage.  This manual is important in  understanding  many
              of the new features.

          4.  TOPS-20 Operator's Guide

              This manual contains information on the new operator  interface
              and  how  to  use  it.   It  also contains information on error
              recovery and information  on  the  updated  KLINIT  and  PARSER
              interface.

          5.  TOPS-20 OPerator's Command Language Reference Manual

              This Manual documents the new command  language.   This  manual
              should   be  consulted  for  detailed  information  about  this
              language or about any of GALAXY's functions.

          6.  User's Command Manual

              This  manual  is  updated  to  include  all  the  new  commands
              available  to  the  user.  The important areas include commands
              that interact with mountable devices, and extensions to various
              other commands.

          7.  Release 4 Update Seminar and Notebook

              Digital's Educational Services group will be offering a Release
              4  update  seminar series soon after the software is available.
              They will also make available (at a price), the materials  used
              in  the  seminar for those that cannot attend.  These materials
                                                                       Page 3


              cover changes in the software and user  interface;   containing
              information on functionality, and command and JSYS interfaces.

          8.  TOPS-20 DECNET-20 Programmers and Operations Manual

              This  document  includes  installation,  usage,  and   checkout
              procedures  for DECNET products.  Information on downline load,
              upline dumping, and loopback testing are in this manual.

          9.  DN200 Programmers and Operations Manual

              This  guide  includes   installation,   usage,   and   checkout
              procedures.   Information  on  downline  load, upline dump, and
              loopback testing are included here.

         10.  TOPS-20 2780/3780/HASP Emulation/Termination Manual

              The procedures for the installation  and  running  of  the  IBM
              communications products are documented in this manual.

         11.  *.BWR and *.DOC, *.MEM files for various products

              These files  (contained  on  the  distribution  tapes)  contain
              important  information  on  features and restrictions which are
              not contained in normal documentation.  It is important to read
              these before attempting to do an installation.

              The file ACJ.MEM is an example of the access control  mechanism
              which  should serve as a basis for any site desiring to utilize
              this feature.




     Installation of Software
     ------------------------


     This  is  a  tightly  coupled  release.   TOPS-20,  DECNET,  DN200   and
     2780/3780/HASP  all  utilize  the new GALAXY features and functionality.
     Because of this, you cannot mix R3A components with R4 components.   You
     CANNOT,  for  instance, put up R4 with the 3A GALAXY system because some
     of the functionality has moved from the  EXEC  to  OPR.   Likewise  both
     DECNET  and  the  2780/3780 count on both GALAXY and monitor features of
     their respective releases.

     You CAN, however, run both R3A and R4 from the same disk packs.  Thus it
     is possible to put up R4 for training and experimentation, and revert to
     R3A for production until you are ready to utilize R4 full time.



     New Features In Release 4 -------------------------
                                                                       Page 4


     The rest of the document covers New features, changes,  and  performance
     considerations for release 4 users.
                                                                       Page 5


                    Major    TOPS-20    Release  4    Features

          TOPS-20 Release 4 contains many new  features  for  administrative,
     operations  personnel,  and users.  While there have been many additions
     to the system, the normal user will see little change in his/her use  of
     the  system  except where new features are employed.  Administrative and
     operations personnel, on the other hand, will find  that  their  command
     interface  to  the system has changed greatly in a manner which provides
     many  new  facilities,  full  command  recognition,  and  an  integrated
     approach to operator software, but which is (alas) different.

          Several projects in Release 4 were designed to  provide  mechanisms
     for  the site administrator to "tune" the performance characteristics of
     the  system.   Other  projects  were  to  improve   the   communications
     facilities  in  both  DECNET and IBM communications products.  And still
     others were to provide more operations and administrative  control  over
     the  system.   The  following  is  a  listing of the major components in
     TOPS-20 Release 4.


     -------------------------------------------
     ! New Features for the Site Administrator !
     -------------------------------------------

     1.  Directory and Program Name Cache

          Release 4 of TOPS-20 will keep a cache of the last  few  referenced
          directories.   This  will  tend to reduce the number of page faults
          required to look up files.  This project does not change  the  user
          interface to the system in any way.

          Another type of cache being kept is the Program  Name  Cache.   The
          names  of  often  used  programs and libraries can be placed in the
          file SYSTEM:PROGRAM-NAME-CACHE.TXT.  At startup,  the  system  will
          map  each  of  the  libraries (via a program called MAPPER.EXE) and
          will reserve an OFN for each of the programs.  The effect  of  this
          is  to decrease the startup time of programs and the access time to
          libraries.


     2.  Working Set Swapping

          Past performance analysis has indicated that as  the  load  on  the
          system  increases,  the length of time that a process's working set
          stays in memory after it blocks decreases.  This causes the process
          to  fault  in more of its working set pages from the swapping space
          once it is unblocked.  Swapping a process's working set causes  all
          the  pages  to  be  written  onto a contiguous area of the swapping
          space.  Then, when the process becomes runnable again, the  monitor
          will read in the entire working set at once.

     3.  Reduction in Scheduler Overhead Due to Excessive Terminal Wakeups

          In order to reduce the scheduler overhead incurred by the  EXEC  or
          other  terminal  oriented processes, Release 4 provides a mechanism
                                                                       Page 6


          for a process to specify an arbitrary set of  wake  up  characters.
          For  instance  this  allows  the EXEC to wake up only on a question
          mark, and not on all punctuation.  This should decrease the  number
          of  times  the  EXEC gets scheduled during the typing of a command.
          Another aspect of this feature is the ability to  wake  up  when  a
          field  of  a  desired  length  has been entered even though a break
          character has not been entered.

          Programs which use the wake up character masks in order to  respond
          to  a  particular  character or which read field by field should be
          changed to use these features  as  a  means  of  decreasing  system
          loading.  Programs which use the TEXTI JSYS will automatically take
          advantage of this feature.


     4.  Scheduler Controls

          TOPS-20 Release 4 will provide the system administrator with a  set
          of  scheduler  controls  that can be used to tune the system to run
          with  the  desired  characteristics  for  that  installation.   The
          following methods for controlling the scheduler are available:

          1.  Bias control

              A  bias  control  has  been  added  which  allows  the   system
              administrator    to   favor   either   interactive   users   or
              computational users.  The control mechanism can  be  set  to  a
              value  between 1 and 20.  When the bias is set to 1, the system
              will  maximally  favor  interactive  users  over  computational
              users.   When  the bias is set to 20, the system will maximally
              favor computational users.  There  is  a  command  to  the  OPR
              program which allows the operator to specify the setting of the
              bias control.

          2.  Class scheduler

              The class scheduler allows the system administrator to  specify
              the percentage of CPU time (share) that any class of users will
              receive.  There are two ways of  placing  users  into  classes.
              One  method  is  to  associate  a  class number with each valid
              account on the system.  When the user logs in, or  changes  the
              account,  the  associated  class  will  take effect.  The other
              method is to set the class via the "Access  Control  Job"  (see
              item 20).  When a job logs in, the access control job (ACJ) has
              the opportunity to associate a class with that job.   Thus  the
              site  can  program  the  ACJ to provide any mapping of users to
              classes which are meaningful.

              The  'share'  of  the  processor  assigned  to  each  class  is
              initially  specified  in  the 4-CONFIG.CMD file.  There are OPR
              commands which allow the operator to change the share  assigned
              to  each  class.   Another  parameter which can be specified is
              whether or not the system should allocate the unused portion of
              a  class's share (the windfall) to other users.  This parameter
              is also initially set in 4-CONFIG.CMD.
                                                                       Page 7


              One simplified use of the class scheduler is to place all batch
              jobs  in one class and all terminal originated jobs in another.
              This provides a method for regulating  the  percentage  of  CPU
              time received by these two different types of users.

          3.  High Priority Queue

              A special  high  priority  queue  has  been  defined  which  is
              searched  before  the  interactive  queues.   A process must be
              explicitly placed in this queue.  This should be done only  for
              processes that need high priority scheduling and which does not
              compute for long periods  of  time.   Normally  programs  which
              provide  services  to  other  jobs  should  be assigned to this
              queue.  The access control program is  an  example  of  such  a
              program.


     5.  Enhanced System Performance Reporting

          The WATCH program has been enhanced during Release 4 to  print  out
          more   system   performance   statistics.    Included  in  the  new
          information reported by WATCH is:

                 1. The working set size of each job,
                 2. The number of page faults taken by each job,
                 3. The average time to satisfy those page faults,
                 4. The number of wake ups for each job,
                 5. The average time to service each wake up,
                 6. The active swapping ratio of the system, and
                 7. The disk seeks, reads, and writes per spindle.

          This version of WATCH includes the capability of the program FRIDAY
          which was distributed with 3A.

     6.  Error Logging

          The following additional entries  are  being  added  to  SYSERR  to
          provides better information for field service.

                 1. KMC11/DUP11 entries on the KL systems 
                 2. Tape reconfiguration entries 
                 3. Event logging from the DECnet front end
                 4. Text entries from the operator's REPORT command


     7.  Accounting Improvements

          Release 4 enters tape mounting information  into  the  USAGE  file.
          This information includes the name of each volume that was mounted,
          the name of the user issuing the mount request, the length of  time
          that  the  tape  was  in use, and the number of characters read and
          written during the time that the tape was mounted.

          Release 4 enters structure utilization information into  the  USAGE
          file.  These entries contain the structure name, the user's account
                                                                       Page 8


          string, and the length of time that  the  user  had  the  structure
          mounted.

          Release 4 also implements a mechanism for the system  administrator
          to  close  out  one shift and start another shift.  This allows the
          system administrator to charge differently for prime  shift  versus
          second  or  third shifts.  This has been done by implementing a new
          USAGE JSYS function.  There is a  mechanism  by  which  the  system
          administrator  can  specify  the  times  of  the  day  of all shift
          changes.  The system will automatically execute  the  change  shift
          function at each of the specified times.

          Other changes include a new entry which has been added  to  support
          file  Archiving,  and  charging the printing of a batch LOG file to
          the user and not to BATCON.

     8.  Access Control Mechanism

          An access control mechanism has been added to TOPS-20 in Release 4.
          This  mechanism  will  allow  each  installation to write an access
          control program to carry out that installation's policies regarding
          privileges and resource assignment.  Some of the resources that can
          be controlled by this facility are:

                 1. Device assignment,
                 2. The enabling of capabilities,
                 3. Creating jobs with CRJOB,
                 4. Logging into the system,
                 5. Logging off the system,
                 6. Creating processes (after Nth process),
                 7. Setting terminal baud rate,
                 8. Setting of ENQ quota,
                 9. Directory creation or modification, 
                10. Structure mounting,
                11. Access to MDDT,
                12. Verification of scheduler class assignment, and
                13. Access to given labeled magnetic tapes.

          An example program "ACJ.MEM"  is  being  distributed  with  release
          four.  This program illustrates many of the techniques which should
          be incorporated in  a  successful  access  control  program.   This
          example  program  is  not  a  full  fledged ACJ in that it does not
          restrict access to any resource.  It merely logs all such  requests
          and then grants the access.  It is, however, a good prototype which
          serves as an illustration of how to write a program which  utilizes
          the access control mechanism and which protects itself from most of
          the calamities which can befall a job running on the system.  It is
          expected  that  most  sites  will extend this program to meet their
          individual  needs.   The  program  will  be  in  the  documentation
          saveset.

     9.  RAMP Projects

          As part of a continuing effort to increase the availability of  the
          DECSYSTEM-20,  a large amount of effort has gone into RAMP features
                                                                       Page 9


          (Reliability and Maintainability Program).  Many of these result in
          different  output  to  SYSERR, and the CTY during error conditions.
          In general, they are invisible to  users  during  normal  operating
          conditions.   The  operator, however, will notice slight changes in
          the dialogue when bringing up the system.  RAMP features are  being
          included in both TOPS-20 and the RSX20F front end system.



     ---------------------------------
     ! New Features for the Operator !
     ---------------------------------

     1.  Dynamic Recognition of Disk and Tape Drives

          The Release 4 monitor will automatically note whenever a disk drive
          or  a  tape  drive  or  a  tape  controller  is added to the system
          configuration.  It will then create  the  necessary  internal  data
          base  to  allow  these  new units to be accessed by the timesharing
          users.  This dynamic recognition will take place without having  to
          reload the TOPS-20 monitor.

          The situations which would activate this dynamic recognition happen
          on the first interrupt after one of the following:


          1.  A disk drive that was not connected to an RH20 or RH11  on  the
              system  when  the  monitor  was initially loaded is switched on
              (via the port/channel switch).

          2.  A disk drive that was completely powered off at  the  time  the
              monitor was loaded is powered on.

          3.  A tape drive whose logic  was  powered  off  at  the  time  the
              monitor was loaded has its logic powered on.

          4.  A tape controller that was powered  off  at  the  time  of  the
              loading of the monitor is powered on.


          This project allows two  DECSYSTEM-20's  to  share  the  same  disk
          drives  in  the following manner.  Configure the hardware such that
          each of the shared disk drives has one port connected to an RH20 on
          the first system and has the other port connected to an RH20 on the
          second system.  The port switches for all of the shared disk drives
          MUST be set to either the Port A or to the Port B positions but NOT
          to the A/B position.  When a  structure  is  to  be  mounted  on  a
          particular system, the following procedure should be followed:

          1.  With the drive powered down, set the port switch to either  the
              'A'  or  'B'  position  (whichever  connects  it to the desired
              system).
                                                                      Page 10


          2.  Mount the desired disk pack on the drive.

          3.  Power up the disk drive.


          At this point the TOPS-20 system will notice that the disk drive is
          on-line and will make it available to the system.

          This project is NOT intended to provide a completely  general  disk
          sharing  facility  between two systems.  For instance, if the drive
          is left in the A/B position, then both systems might try to  access
          the  drive  which  WOULD LEAD TO THE DESTRUCTION of the data on any
          structure mounted on that drive.

     2.  Dynamic Reconfiguration of MOS Memory and the Tape Subsystem

          1.  When the system contains MOS memory, a system  program  is  run
              which  responds  to memory errors.  This program's name is TGHA
              and runs unattended much in  the  manner  of  DDMP.   The  TGHA
              program  can  take  failing  memory  off-  line and can perform
              "spare bit substitution".

          2.  There is a new OPR/ORION command added  as  part  of  the  tape
              labeling  project to take on or off-line any of the magtapes on
              the system.  This  command  will  make  an  appropriate  SYSERR
              entry.


     3.  New GALAXY Functionality

          1.  Release 4 of TOPS-20 does not include the QUENCH program.   The
              remaining  extra functionality provided by QUENCH under Release
              3 has been moved into the EXEC.  This includes the support  for
              the DN64/DN65 commands for submitting jobs to an IBM system and
              support for releasing deferred spool files.

          2.  The EXEC has been changed  to  support  the  Release  4  GALAXY
              message format.

          3.  There is a new GETJI/SETJB function to mark that a  job  is  at
              command  level.   The  EXEC  and  PA1050  use this JSYS to tell
              BATCON when the job is at command level.

          4.  The TOPS-20 monitor keeps a Batch Stream Number for each  batch
              job  on  the  system  and  to  allow  the operator to permit or
              inhibit communication between a batch job and the operator.

          5.  A large change in  the  operator  interface  has  taken  place.
              Instead  of  controlling  the  system  environment  by  talking
              directly to the various system programs, the operator now works
              thru  a  unified  mechanism  which is provided by the OPR/ORION
              interface.  The operator communicates through a unified command
              language to the OPR program which in turn communicates with the
              ORION program to carry out the required actions.
                                                                      Page 11


          6.  The  GALAXY  components  now   run   "native   mode"   on   the
              DECSYSTEM-20.  This improves their performance and lowers their
              overhead.

          7.  A log file is kept by the ORION program into which  all  GALAXY
              operator  message  traffic  is  stored.  In the case of a fatal
              error (stopcode) occurs in a GALAXY component, a  large  amount
              of  information  is  recorded  here  and on the terminal.  This
              information is  extremely  helpful  to  someone  analyzing  the
              error.


     4.  Increased Tape Utilization by DUMPER

          Currently DUMPER writes 518 word records on tape (1 file page  plus
          6  header  and  checksum  words).  Since Release 4 will support two
          tape drives capable of writing data at 6250 CPI,  using  DUMPER  on
          these  tape  drives  would mean that approximately half of the tape
          would be wasted in inter-record gaps.  To reduce this  wastage  and
          to   increase  the  amount  of  data  stored  on  a  tape,  we  are
          implementing a record blocking mode in DUMPER so that it can  write
          several file pages in a single tape record.



     -----------------------------
     ! New Features for the User !
     -----------------------------

     1.  The SWTRP JSYS

          In order to reduce the time that it takes  an  OTS  to  service  an
          arithmetic  or  a  floating point overflow, we have implemented the
          SWTRP JSYS to let user programs set the trap words in the user page
          table  (UPT).   This  will  allow the process to trans- for control
          directly to the user program to service the over- flow condition.

     2.  ANSI Tape Label Support

          The Release 4 tape label facility provides for level 4  tape  label
          verification   and  creation  according  to  the  ANSI  Tape  Label
          standard.  The tape label facility provides for multi-file  volumes
          and   multi-volume   files.   The  facility  also  provides  record
          processing of fixed, variable, and  spanned  record  formats.   The
          tape  mounting facility provided as a part of this project includes
          automatic  volume  recognition  (AVR)  in  both  the  attended  and
          unattended environments.

          IBM (EBCDIC) labeled tapes can also be read.  They cannot, however,
          be created under the tape labeling system.


     3.  DECnet Task-To-Task Support Increased

          Release   3A   of   TOPS-20   supported   DECnet-20    Task-to-Task
                                                                      Page 12


          communications.    Any   DECSYSTEM-20   or  DECSYSTEM-2020  can  be
          connected to the following other  DECnet  products:   RSTS,  RT-11,
          RSX11/M, IAS, VAX, DECSYSTEM-2040, 2050, 2060, or a DECSYSTEM-2020.

          In Release 3A, the DECSYSTEM-2040,  2050,  or  2060  systems  could
          support  up  to  one DECnet Task-to-Task link.  This limitation has
          been raised to eight links in  Release  4.   A  DECSYSTEM-2020  can
          support  up  to  two  lines for Task-to-Task in both Release 3A and
          Release 4.

          A Network File Transfer Facility is available with Release 4  which
          will  enable  users  to easily pass files between systems which are
          connected with DECnet.


     4.  New Leader Format for the ARPANET Protocol

          The ARPANET Protocol was originally designed with  a  limit  of  64
          IMPs  on  the  network.   Recently  this  limit was reached and the
          protocol was modified to make it possible to address more  than  64
          IMPs.   Release  4 of TOPS-20 incorporates the changes necessary to
          support this new leader format.


     5.  Execute Only Capability

          Release 4 of TOPS-20 supports  the  "Execute  Only"  protection  of
          files.  Specifically, an executable file (program.EXE) can be given
          an "Execute Only" protection.  That file can then be  executed  via
          the "R" or "RUN" commands.  However, that file cannot be copied, or
          read;  and the program cannot be saved, examined, modified, mapped.
          Likewise,  the  monitor  will not allow DDT or user versions of the
          Compatibility  Package  merged  into  the  address  space  of  that
          program.

          A limitation of the Execute Only facility is that an "Execute Only"
          program cannot merge any other "Execute Only" programs into its own
          address space.  This means that an "Execute  Only"  program  cannot
          call  an  "Execute  Only"  object time system nor can it map in any
          "Execute Only" overlays.

     6.  HASP Multileaving Support

          The DN60 software has been extended to provide not only 2780/ 3780,
          but  also  HASP  Multileaving  support.   This  will allow multiple
          devices to be active  concurrently,  will  provide  remote  station
          console  support,  and will permit convenient operator enquiry from
          the remote station.

     7.  Remote Job Entry Station (DN200)

          Release 4 of TOPS-20 supports  a  PDP-11  based  remote  job  entry
          station.  OPR, LPTSPL, and CDRIVE running on the -20 communicate to
          the remote PDP-11 using a DECnet-20 Task-to-Task link.   There  are
          tasks  running in the PDP-11 to drive the LPT, CDR, and the console
                                                                      Page 13


          terminal.

     8.  The EXEC Interface to the COBOL-68 and COBOL-74 Compilers

          The EXEC has been enhanced to let  the  user  specify  which  COBOL
          compiler is to be used during the compilation of any COBOL program.

     9.  More Efficient Asynchronous Terminal Support

          Overhead  for  asynchronous  terminal  support  has  been  reduced.
          Coupled with an improvement in XON/XOFF handling, users should find
          that terminal-bound applications run more efficiently.

     10.  Support of the TV Editor

          Release 4 includes TV as a supported TOPS-20  editor.   This  is  a
          screen  oriented editor that is based on TECO.  This editor runs on
          all supported DEC terminals (both video and hard copy terminals).

     11.  File Archiving

          Release 4 also includes a file archiving system.   This  system  is
          based  on  DUMPER.   The  archiving system is capable of running in
          both an archiving mode and a virtual disk mode.

          The file archiving system will allow users to request that files be
          archived  onto  tape.   The data in these files can then be deleted
          from the disk, freeing up valuable disk space.  The contents of the
          files  can  be  recalled from tape at any time in the future.  This
          recall can be done by explicit request or  automatically  when  the
          file is opened.
                                                                      Page 14
     TOPS-20 Release 4 User Interface Changes


               TOPS-20    Release  4    User  Interface    Changes


             The following  reflect  many  of  the  changes  in  the  TOPS-20
        interface  seen  by  administrators, operators, and normal users.  In
        most cases, the normal user will not  be  severely  impacted  by  the
        changes  in  that  most are additions to existing functionality.  The
        impact will be greatest on  the  administrator,  operator  and  those
        users who utilize the tape system.

        CHANGES: ADMINISTRATOR

             o Class Scheduling
                     -- CONFIG.CMD file
                        -- BATCH-CLASS n (class for batch jobs)
                        -- CREATE n m (sets class' (n) CPU share (m%))
                        -- ENABLE CLASS-SCHEDULER (turns on class schedulER)
                     -- Commands
                        -- (in OPR)SET SCHEDULER CLASS n (TO) m (percent)
                        -- (in OPR)SET SCHEDULER BATCH-CLASS n
                        -- (in OPR)ENABLE CLASS-SCHEDULER ....
                        -- (in OPR)DISABLE CLASS-SCHEDULER

             o Bias Control
                     -- CONFIG.CMD file
                        -- BACKGROUND (run batch jobs on lowest queue)
                        -- BIAS n (initial setting of bias control)
                     -- Commands
                        -- (in OPR)SET SCHEDULER BIAS-CONTROL (TO) n.

             o Access Control
                     -- Access Control Program written to meet local sites
                             requirements.

             o 4-CONFIG.CMD file choices
                     -- CHANGE (ACCOUNT SHIFT AT) <time> (ON) <days>
                     -- ENABLE TAPE DRIVE ALLOCATION (users to utilize
                             MOUNT command for some or all tape drives).
                     -- ENABLE WORKING-SET-PRELOADING
                     -- TAPE-RECOGNITION-ERRORS <action> (unload or assume
                             unlabeled when wrong tape mounted).
                     -- TAPE-RECYCLE-PERIOD (for migration)

        CHANGES: OPERATORS

             o Command Interface (no detail given here)
                     -- Fundamentally changes the interface from one where
                        the operator converses with each individual operations
                        task, to an integrated interface where a specialized
                        executive (OPR) provides a consistent command language
                        for interacting with operations tasks.
             o Archiving/Migration
                     --REAPER program
                     --New Functionality in DUMPER
                                                                      Page 15
     TOPS-20 Release 4 User Interface Changes


             o Labeled Tapes
                     --New Commands (in OPR)
                     --More controlled environment
             o Changes in Error Output
                     --Additional Bug(hlt,chk,inf) information
                     --More CTY information on KL failure

        CHANGES: USER

             o Mountable Device Interfaces (disk/tape)
                     -- ASSIGN  (cannot use for controlled device)
                     -- DEASSIGN(cannot use for controlled device)
                     -- MOUNT request(supercedes TMOUNT/SMOUNT)
                     -- DISMOUNT request
                     -- REWIND (includes current tape or volume set)
                     -- UNLOAD (illegal for MOUNTed devices)

             o Archived Files
                     -- ARCHIVE Command
                     -- RETRIEVE Command
                     -- SET RETRIEVAL-WAIT (for offline files)
                     -- Potentially smaller directories
                     -- CANCEL (ARCHIVE) request
                     -- DELETE filespec,
                             ARCHIVE (files included) CONTENTS (only)

             o Other Command Enhancements
                     -- COMPILE /LANGUAGE-SWITCHES:(..)/74-COBOL
                     -- similar LOAD and EXECUTE
                     -- COPY  (byte size settable)
                     -- CREATE/EDIT  (set default editor)
                     -- INFORMATION (several items updated)
                     -- PRINT (and related commands)(new and
                             modified switches)
                     -- SET DEFAULT (new options)
                     -- SET FILE (new options)
                     -- SET LOCATION <node> (new option)
                     -- SYSTAT (new options)
                     -- TERMINAL (MODE IS) (new options)

             o TV screen editor support

             o DECNET
                     -- Expanded number of nodes (on 2040/2050/2060)
                     -- Network File Transfer Program
                        -- COPY, DELETE, DIRECTORY, SUBMIT commands

             o 2780/3780/HASP
                     -- New addition of HASP capability
                     -- New Spooler 
                     -- Commands all interpreted by the EXEC
                                                                      Page 16
     Performance Considerations With Release 4


                    Performance Considerations With Release 4



          In release 4, a greater emphasis has been placed on providing  good
     interactive  responsiveness  than  was placed on this in 3A.  There have
     been a number of projects including:

          1.  Increasing the terminal output rate.

          2.  Providing a more  controlled  breakset  to  eliminate  unneeded
              wakeups (and scheduling overhead).

          3.  Redefining the scheduler queues to provide a "very interactive"
              and a "was just very interactive" queue.

          4.  Tuning capability using the bias control.

          5.  Interactive priority even with class scheduling.


     There is no across the board increase in performance with release  4  as
     compared  to release 3A.  In general, some components will run faster at
     the expense of others.  In a system that is running  at  full  capacity,
     there  may  be  a  a  decrease in throughput accompanying an increase in
     responsiveness.  The bias control and the class scheduler  are  provided
     as tools to allow you to bias the system to your needs.

          In order to provide the new functionality in release 4,  a  lot  of
     code  and  some  new tables were added, tables were expanded, and system
     defaults were changed.  Significant increases were made in the  defaults
     governing  the  amount of swapping space allocated (NDST) and the number
     of open files (NOFN).  These increases were  made  because  of  evidence
     that  both  program  size and file usage are increasing at many customer
     sites.  The sum of these increases adds about 20 pages to  the  resident
     monitor   (including   8  pages  for  increased  swapping  space).   The
     non-resident portions of the monitor have also grown as as functionality
     was added.  The effects of these increases will be:

          1.  Less memory available for user tasks.

          2.  More swapping necessary to sustain current load.

          3.  Performance on systems which are paging heavily under 3A may be
              worse.  Tuning will often help, but on small systems (less than
              256K) with heaving paging, it may not be able to compensate for
              the  loss  of  memory.  In these cases, it is often possible to
              use the class scheduler to increase the performance of  certain
              classes  of  users  at  the  expense  of others;  however total
              system performance may still remain at less than 3A levels.

                                                                      Page 17
     Performance Considerations With Release 4


     SUMMARY OF WHAT GREW IN TOPS-20 RELEASE 4.

       -- Resident Monitor Requires More Dedicated Space

          -- More Code Added

          -- Larger Defaults For:

             -- Swapping Area
             -- Number of OFN's

          -- Larger entry's required in:

             -- Job tables
             -- Process tables
             -- Terminal tables
             -- Added Caching of Information

       -- Larger Non-resident Monitor

             -- More Code Added
             -- More Per-Process Information
             -- More Per-Job Information
             -- More Per-Terminal Information

       -- Increase of about 12 pages with same amount of swapping space.

       -- Mapping additional swapping space requires about 8 pages more.

       -- Directories hold potentially fewer files because of Archiving
          entries
                                                                      Page 18
     Performance Considerations With Release 4


     SUMMARY OF FEATURES RELATED TO PERFORMANCE/TUNABILITY

       -- Working Set Preloading

       -- Scheduler Controls

          -- Class Scheduler
          -- Bias Control

       -- Interactive Responsiveness Increased

          -- Optimized breakmask lowers EXEC overhead
          -- Terminal throughput increased
          -- New Scheduler Queues
          -- Directory and Name caches, find commonly used
              objects with less overhead

       -- GALAXY runs without PA1050 (Native Mode)

       -- WATCH Helps Pinpoint Resource Usage

          -- New System Variables
          -- "FRIDAY-like" per job data
                                                                      Page 19
     Performance Considerations With Release 4


     USING THE TUNING TOOLS TO ENHANCE PERFORMANCE


          1.  When interactive users are most important

              1.  Have batch jobs run on lowest queue (CONFIG.CMD)

              2.  Have batch jobs put in special class(CONFIG.CMD)

              3.  Use  bias  control  to  do  "disaster   avoidance"   (stops
                  scheduling   computational   users  when  interactive  load
                  average reaches a certain threshold.)

              4.  Experiment  with  working  set  swapping  (CONFIG.CMD)   to
                  determine  if  it  helps.   (It  has proven to decrease the
                  number of disk seeks in some workloads).  It  may  increase
                  total swapping.


          2.  When there is a high  priority  process  (like  a  file  update
              program which communicates with other programs

              1.  Put that program in the high priority queue.

              2.  Put associated programs in a class with a high percentage

              3.  Put other users in a class with a lower percentage.


          3.  When groups of users have different importance

              1.  Put users in scheduling classes on a group basis.

              2.  Allocate appropriate shares to classes.

              3.  Put operations jobs in another class.


          4.  When trying to increase across the board performance

              1.  determine if working set swapping helps.

              2.  Determine which setting of the bias control is best.

              3.  Put users in classes based on user profile  (good  vrs  the
                  bad).

              4.  Write a program to change bias and/or class  targets  based
                  on local heuristics.

              5.  Use WATCH to determine if  disk  traffic  is  balanced,  to
                  monitor users with large requirements, and to spot trends.

    